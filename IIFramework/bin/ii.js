window.numas={},window.ii=window.numas,window.__extends=this&&this.__extends||function(){let i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},i(e,t)};return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),function(t){let r=(e.Borrow=function(){return t.ReferencePool.Borrow(e)},e.prototype.Return=function(){t.ReferencePool.Return(e,this)},e.prototype.SetCallback=function(e){this.m_Callback=e},e.prototype.OnBindingValueChanged=function(e,t){return this.m_Callback(e,t)},e.prototype.Reset=function(){this.m_Callback=null},e);function e(){this.m_Callback=null}let s=(n.prototype.Reset=function(){null!=this.handler&&this.handler.Return(),this.handler=null,this.target=null},n.Borrow=function(){return t.ReferencePool.Borrow(n)},n.prototype.Return=function(){t.ReferencePool.Return(n,this)},n);function n(){this.handler=null,this.target=null}var i=(o.prototype.Reset=function(){this.UnbindAll(),this.m_CacheValue=null},o.prototype.ReturnBy=function(e){return e.AutoReturn(this)},Object.defineProperty(o.prototype,"v",{get:function(){return this.m_CacheValue},set:function(e){var t=this.m_CacheValue;this.IsEqual(e,t)||(this.m_CacheValue=e,this.NotifyObservers(e,t))},enumerable:!1,configurable:!0}),o.prototype.SetValueWithoutNotification=function(e){this.m_CacheValue=e},o.prototype.NotifyObservers=function(t,n){this.m_ObserversList.ForEach(function(e){return e.handler.OnBindingValueChanged(t,n)})},o.prototype.Bind=function(e,t,n){let i=r.Borrow();i.SetCallback(e);let o=s.Borrow();return o.handler=i,o.target=n,this.m_ObserversList.Enqueue(o),t&&i.OnBindingValueChanged(this.v,this.v),this},o.prototype.TargetUnbind=function(t){this.m_ObserversList.Remove(function(e){return e.target===t},function(e){return e.Return()})},o.prototype.UnbindAll=function(){this.m_ObserversList.RemoveAll(function(e){return e.Return()})},o);function o(e){this.m_CacheValue=null,this.m_ObserversList=null,this.m_ObserversList=t.AnyQueue.Borrow(),this.m_CacheValue=e}t.BV=i}(numas=numas||{}),function(o){var e,t=(e=o.BV,__extends(r,e),r.prototype.IsEqual=function(e,t){return e===t},r.Borrow=function(e){let t=o.ReferencePool.Borrow(r);return t.m_CacheValue=e,t},r.prototype.Return=function(){o.ReferencePool.Return(r,this)},r.BorrowAsLS=function(t,e,n){let i=o.ReferencePool.Borrow(r);return i.m_CacheValue=o.LSMgr.ins.getBoolWithDefault(t,e),i.Bind(function(e){return o.LSMgr.ins.setBool(t,e,n)},!1,i),i},r.BorrowAsUserLS=function(t,e,n){let i=o.ReferencePool.Borrow(r);return i.m_CacheValue=o.UserLSMgr.ins.getBoolWithDefault(t,e),i.Bind(function(e){return o.UserLSMgr.ins.setBool(t,e,n)},!1,i),i},r);function r(){return e.call(this,!1)||this}o.BooleanBV=t;var n,t=(n=o.BV,__extends(s,n),s.prototype.IsEqual=function(e,t){return e===t},s.Borrow=function(e){let t=o.ReferencePool.Borrow(s);return t.m_CacheValue=e,t},s.prototype.Return=function(){o.ReferencePool.Return(s,this)},s.BorrowAsLS=function(t,e,n){let i=o.ReferencePool.Borrow(s);return i.m_CacheValue=o.LSMgr.ins.getIntWithDefault(t,e),i.Bind(function(e){return o.LSMgr.ins.setInt(t,e,n)},!1,i),i},s.BorrowAsUserLS=function(t,e,n){let i=o.ReferencePool.Borrow(s);return i.m_CacheValue=o.UserLSMgr.ins.getIntWithDefault(t,e),i.Bind(function(e){return o.UserLSMgr.ins.setInt(t,e,n)},!1,i),i},s);function s(){return n.call(this,0)||this}o.NumberBV=t;var i,t=(i=o.BV,__extends(u,i),u.prototype.IsEqual=function(e,t){return e<=t},u.Borrow=function(e){let t=o.ReferencePool.Borrow(u);return t.m_CacheValue=e,t},u.prototype.Return=function(){o.ReferencePool.Return(u,this)},u.BorrowAsLS=function(t,e,n){let i=o.ReferencePool.Borrow(u);return i.m_CacheValue=o.LSMgr.ins.getIntWithDefault(t,e),i.Bind(function(e){return o.LSMgr.ins.setInt(t,e,n)},!1,i),i},u.BorrowAsUserLS=function(t,e,n){let i=o.ReferencePool.Borrow(u);return i.m_CacheValue=o.UserLSMgr.ins.getIntWithDefault(t,e),i.Bind(function(e){return o.UserLSMgr.ins.setInt(t,e,n)},!1,i),i},u);function u(){return i.call(this,0)||this}o.MaxNumberBV=t;var a,t=(a=o.BV,__extends(l,a),l.prototype.IsEqual=function(e,t){return e==t},l.Borrow=function(e){let t=o.ReferencePool.Borrow(l);return t.m_CacheValue=e,t},l.prototype.Return=function(){o.ReferencePool.Return(l,this)},l.BorrowAsLS=function(t,e,n){let i=o.ReferencePool.Borrow(l);return i.m_CacheValue=o.LSMgr.ins.getStringWithDefault(t,e),i.Bind(function(e){return o.LSMgr.ins.setString(t,e,n)},!1,i),i},l.BorrowAsUserLS=function(t,e,n){let i=o.ReferencePool.Borrow(l);return i.m_CacheValue=o.UserLSMgr.ins.getStringWithDefault(t,e),i.Bind(function(e){return o.UserLSMgr.ins.setString(t,e,n)},!1,i),i},l);function l(){return a.call(this,"")||this}o.StringBV=t;var c,t=(c=o.BV,__extends(p,c),p.prototype.IsEqual=function(e,t){return!1},p.Borrow=function(e){let t=o.ReferencePool.Borrow(p);return t.m_CacheValue=e,t},p.prototype.Return=function(){o.ReferencePool.Return(p,this)},p.BorrowAsLS=function(t,e,n){let i=o.ReferencePool.Borrow(p);return i.m_CacheValue=o.LSMgr.ins.getObjectWithDefault(t,e),i.Bind(function(e){return o.LSMgr.ins.setObject(t,e,n)},!1,i),i},p.BorrowAsUserLS=function(t,e,n){let i=o.ReferencePool.Borrow(p);return i.m_CacheValue=o.UserLSMgr.ins.getObjectWithDefault(t,e),i.Bind(function(e){return o.UserLSMgr.ins.setObject(t,e,n)},!1,i),i},p);function p(){return c.call(this,null)||this}o.ObjectBV=t}(numas=numas||{}),function(s){let n=(e.prototype.Reset=function(){null!==this.target&&(this.target.decRef(),this.target=null)},e.Borrow=function(){return s.ReferencePool.Borrow(e)},e.prototype.Return=function(){s.ReferencePool.Return(e,this)},e.prototype.ReplaceWith=function(e){return e.addRef(),this.Reset(),this.target=e,this},e);function e(){this.target=null}var t,i=(t=cc.Component,__extends(o,t),o.prototype.onDestroy=function(){this.StopAllScheduler(),this.offGlobal(),this.RemoveAllAssetProperty(),this.Destroy_AutoRelease(),this.RemoveAllUserData()},Object.defineProperty(o.prototype,"_i_userdata",{get:function(){return null===this.__im_UserData&&(this.__im_UserData=new Map),this.__im_UserData},enumerable:!1,configurable:!0}),o.prototype.SetUserData=function(e,t){this._i_userdata.set(e,t)},o.prototype.GetUserData=function(e){return this._i_userdata.get(e)},o.prototype.HasUserData=function(e){return this._i_userdata.has(e)},o.prototype.RemoveUserData=function(e){this._i_userdata.delete(e)},o.prototype.RemoveAllUserData=function(){null!==this.__im_UserData&&this._i_userdata.clear()},o.prototype.onGlobal=function(e,t){return s.EventCenter.ins.on(e,t,this)},o.prototype.emitGlobal=function(e,t,n,i,o,r){s.EventCenter.ins.emit(e,t,n,i,o,r)},o.prototype.offGlobal=function(){s.EventCenter.ins.targetOff(this)},o.prototype.AutoReturn=function(e){return this._I_AutoReleaseItemQueue.Enqueue(s.AutoReleaseItem.Borrow(e,s.EItemType.IReference)),e},o.prototype.GetDataCache=function(e){return s.ResMgr.ins.GetDataCache(e)},o.prototype.AddAutoReleaseDataCache=function(e,t){s.ResMgr.ins.AddDataCache(e,t),this._I_AutoReleaseItemQueue.Enqueue(s.AutoReleaseItem.Borrow(e,s.EItemType.DataCache))},o.prototype.AutoReleaseRes=function(e){var t=this;"string"==typeof e?this.__AutoReleaseRes(e):e.forEach(function(e){return t.__AutoReleaseRes(e)})},o.prototype.__AutoReleaseRes=function(e){s.ResMgr.ins.AddResRef(e),this._I_AutoReleaseItemQueue.Enqueue(s.AutoReleaseItem.Borrow(e,s.EItemType.ResKey))},o.prototype.Destroy_AutoRelease=function(){null!=this._i_AutoQueue&&(s.ResMgr.ins.DestroyAutoReleaseItems(this._i_AutoQueue),this._i_AutoQueue.Return(),this._i_AutoQueue=null)},Object.defineProperty(o.prototype,"_I_AutoReleaseItemQueue",{get:function(){return null===this._i_AutoQueue&&(this._i_AutoQueue=s.AnyQueue.Borrow()),this._i_AutoQueue},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"_i_RefData",{get:function(){return null===this.__im_RefData&&(this.__im_RefData=new Map),this.__im_RefData},enumerable:!1,configurable:!0}),o.prototype.SetAssetProperty=function(e,t){return this._i_RefData.has(e)?this._i_RefData.get(e).ReplaceWith(t):this._i_RefData.set(e,n.Borrow().ReplaceWith(t)),t},o.prototype.RemoveAllAssetProperty=function(){null!==this.__im_RefData&&(this.__im_RefData.forEach(function(e){return e.Return()}),this.__im_RefData.clear(),this.__im_RefData=null)},Object.defineProperty(o.prototype,"_I_SchedulerMap",{get:function(){return null===this.__im_SchedulerMap&&(this.__im_SchedulerMap=new Map),this.__im_SchedulerMap},enumerable:!1,configurable:!0}),o.prototype.HasScheduler=function(e){return null!==this.__im_SchedulerMap&&this.__im_SchedulerMap.has(e)},o.prototype.RegisterScheduler=function(e,t){this.HasScheduler(e)&&console.error(this.name+".RegisterScheduler >> 已注册有调度函数 >> 关键字"+e),this._I_SchedulerMap.set(e,t)},o.prototype.StartScheduler=function(e,t,n,i,o){void 0===i&&(i=cc.macro.REPEAT_FOREVER),void 0===o&&(o=0),this.HasScheduler(e)||(this.RegisterScheduler(e,t),this.schedule(t,n,i,o))},o.prototype.StopScheduler=function(e){var t;this.HasScheduler(e)&&(t=this.__im_SchedulerMap.get(e),this.__im_SchedulerMap.delete(e),this.unschedule(t))},o.prototype.StopAllScheduler=function(){var t=this;if(null!==this.__im_SchedulerMap){let e=this.__im_SchedulerMap;this.__im_SchedulerMap=null,e.forEach(function(e){return t.unschedule(e)}),e.clear()}},o);function o(){let e=null!==t&&t.apply(this,arguments)||this;return e.__im_UserData=null,e._i_AutoQueue=null,e.__im_RefData=null,e.__im_SchedulerMap=null,e}s.BaseComp=i}(numas=numas||{}),function(u){let a=(Object.defineProperty(e,"ins",{get:function(){return null===this._ins&&(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),e._ins=null,e);function e(){this.loaderCnt=u.NumberBV.Borrow(0),this.totalTaskCnt=u.NumberBV.Borrow(0),this.finishTaskCnt=u.NumberBV.Borrow(0)}u.ResListLoaderInfo=a;var t,n=(t=u.BaseComp,__extends(s,t),Object.defineProperty(s,"LOAD_EVENT",{get:function(){return++this._s_LOAD_EVENT_ID,"_i_ResKeeper_"+this._s_LOAD_EVENT_ID},enumerable:!1,configurable:!0}),s.prototype.PositionTo=function(e,t,n){return this.node.setPosition(e,t,n),this},s.prototype.onDestroy=function(){this.RemoveAllIIClickHandler(),this.Destroy_LoadResKey(),t.prototype.onDestroy.call(this)},Object.defineProperty(s.prototype,"Task",{get:function(){return u.UIUtil.getOrAddComponent(this.node,u.task.TaskComponent)},enumerable:!1,configurable:!0}),s.prototype.UUID_GROUP_KEY=function(e){return""+this.uuid+e},s.prototype.LoadRes=function(e,n,i,t){var o=this;void 0===t&&(t=null),this._i_b_LoadFunctionCalled=!0;var r=s.LOAD_EVENT;u.ResMgr.ins.node.on(r,function(e,t){i&&o.AutoReleaseRes(t),n(e,t)},this),null!=t?u.ResMgr.ins.LoadWithEventByGroup(r,e,t):u.ResMgr.ins.LoadWithEvent(r,e)},s.prototype.Destroy_LoadResKey=function(){this._i_b_LoadFunctionCalled&&(this._i_b_LoadFunctionCalled=!1,u.ResMgr.ins.node.targetOff(this))},s.prototype.LoadResList=function(e,n,i,o,r){var s=this;if(void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===r&&(r=5),0!=e.length){o?u.UIMgr.ins.AddWaitingRef():u.UIMgr.ins.AddBlockRef(),i||(a.ins.totalTaskCnt.v+=e.length,++a.ins.loaderCnt.v);let t=this.Task;e.forEach(function(e){s.AutoReleaseRes(e),t.AddFunc(function(n){u.ResMgr.ins.Load(e,function(e,t){i||++a.ins.finishTaskCnt.v,n()})})}),t.Run(r,function(){i||(--a.ins.loaderCnt.v,0==a.ins.loaderCnt.v&&(a.ins.finishTaskCnt.v=0,a.ins.totalTaskCnt.v=0)),o?u.UIMgr.ins.DecWaitingRef():u.UIMgr.ins.DecBlockRef(),u.Util.safeCall(n)})}else u.Util.safeCall(n)},s.prototype.OnIIClick=function(t,n){if(null!=n){if(this.m_IIEventHandler.has(n)){let e=this.m_IIEventHandler.get(n);return e(t)}console.info("UIComp::OnIIClick >> 点击事件 "+n+" 没有响应函数")}else console.info("UIComp::OnIIClick >> 按钮点击未设置关键字 CustomData")},s.prototype.SetIIClickHandler=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=0),this.m_IIEventHandler.set(e,function(e){0<i&&u.UIMgr.ins.blockSeconds(i,null),n||u.AudioMgr.ins.PlayEffect(),t&&t(e)})},s.prototype.RemoveIIClickHandler=function(e){this.m_IIEventHandler.has(e)&&this.m_IIEventHandler.delete(e)},s.prototype.RemoveAllIIClickHandler=function(){this.m_IIEventHandler.clear()},s._s_LOAD_EVENT_ID=0,s);function s(){let e=null!==t&&t.apply(this,arguments)||this;return e._i_b_LoadFunctionCalled=!1,e.m_IIEventHandler=new Map,e}u.BaseUIComp=n}(numas=numas||{}),function(i){var t,e=(t=i.BaseUIComp,__extends(n,t),Object.defineProperty(n.prototype,"FrameRate",{get:function(){return 60},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AppTracing",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"p",{get:function(){return this._platform},enumerable:!1,configurable:!0}),n.prototype.onLoad=function(){var e=this;CC_DEBUG&&console.info(">> App::onLoad"),null===n.ins?n.ins=this:this.destroy(),this._canvas=this.getComponent(cc.Canvas),this.AdapterCanvas(this._canvas),cc.game.addPersistRootNode(this.node),this.setDisplayStats(!1),this.setFrameRate(this.FrameRate),this.addComponent(i.LSMgr).UseDefaultHelper(),this.addComponent(i.UserLSMgr).UseDefaultHelper(),this.addComponent(i.ResMgr),this.addComponent(i.UIMgr),this.addComponent(i.AudioMgr).UseDefaultHelper(),this._platform=this.addComponent(this.GetPlatformComponent()).Init(this.sdkCfg),i.LangUtil.AddLangCfg(i._LangCfg_DefaultJson),i.registerPrefabCfg(i.IIStartPrefabCfg.dft,this.START_BUNDLE_NAME),i.registerPrefabCfg(this.StartBundlePrefabCfg,this.START_BUNDLE_NAME);var t=i.Util.onceCall(function(){e.__LoadStartResListAndOnLoad()},3);i.UIMgr.ins.Open(i.IIStartPrefabCfg.dft.panel.BlockInputUIPanel.key,null,t),i.UIMgr.ins.Open(i.IIStartPrefabCfg.dft.panel.LoadingUIPanel.key,null,t),i.UIMgr.ins.Open(i.IIStartPrefabCfg.dft.panel.WaitingUIPanel.key,null,t)},n.prototype.__LoadStartResListAndOnLoad=function(){let e=[];for(var t in this.StartBundlePrefabCfg.panel)e.push(this.StartBundlePrefabCfg.panel[t].key);for(var n in this.StartBundlePrefabCfg.comp)e.push(this.StartBundlePrefabCfg.comp[n].key);this.LoadResList(e,this.OnPreAppLoad.bind(this),!0,!0)},n.prototype.OnPreAppLoad=function(){var t=this;this.AppTracing&&i.PlatformUtil.IsiOS?i.iOSATT.ins.RequestTrackingAuthorization(function(e){t.OnAppLoad()},!0):this.OnAppLoad()},n.prototype.EnterFirstGame=function(e){this.p.ad.InitByScript(),i.UIMgr.ins.LoadBundleStage(e)},n.prototype.setDisplayStats=function(e){return CC_DEBUG&&console.info(">> App::setDisplayStats: "+e),cc.debug.setDisplayStats(e),this},n.prototype.setFrameRate=function(e){return CC_DEBUG&&console.info(">> App::setFrameRate: "+e),cc.game.setFrameRate(e),this},n.prototype.FitHeight=function(){this._canvas.fitHeight=!0,this._canvas.fitWidth=!1},n.prototype.FitWidth=function(){this._canvas.fitWidth=!0,this._canvas.fitHeight=!1},n.prototype.FitCanvas=function(){let e=this._canvas;var t=e.designResolution.width,n=e.designResolution.height;return cc.winSize.width*n<=t*cc.winSize.height?(e.fitHeight=!1,e.fitWidth=!0):(e.fitHeight=!0,e.fitWidth=!1),CC_DEBUG&&console.info(">> App::FitCanvas: fitHeight="+e.fitHeight+" fitWidth="+e.fitWidth+" "),this},n.prototype.FitCanvasWithVisiableSize=function(e,t){let n=this._canvas;var i=n.designResolution.width,o=n.designResolution.height;return console.assert(e<=i&&t<=o,"屏幕适配 >> 传入的可视区域必须小于设计分辨率"),n.designResolution=cc.size(e,t),cc.winSize.width*t<=e*cc.winSize.height?(n.fitHeight=!1,n.fitWidth=!0):(n.fitHeight=!0,n.fitWidth=!1),this.node.setContentSize(cc.winSize),CC_DEBUG&&console.info(">> App::FitCanvas: fitHeight="+n.fitHeight+" fitWidth="+n.fitWidth+" "),this},n.prototype.delayCall=function(e,t,n){void 0===n&&(n=!1),n?i.UIMgr.ins.blockSeconds(e,t):this.scheduleOnce(t,e)},n.prototype.Debug=function(){console.info(">> App::Debug"),i.ResMgr.ins.Debug(),i.UIMgr.ins.Debug(),i.ReferencePool.Debug()},n.prototype.GetPlatformComponent=function(){return i.PlatformUtil.IsWechat?i.WeChatPlatform:i.PlatformUtil.IsiOS?i.iOSPlatform:i.DefaultPlatform},n.ins=null,n);function n(){let e=null!==t&&t.apply(this,arguments)||this;return e._canvas=null,e._platform=null,e.START_BUNDLE_NAME="StartBundle",e}i.App=e}(numas=numas||{}),(numas=numas||{}).Cfg={DefaultUserKey:"ii@1986"},function(e){var t=(n.IsSystemLanguageChinese=function(){return cc.sys.language==cc.sys.LANGUAGE_CHINESE},n.InitSysLang=function(){this._init||(this._init=!0,this.IsSystemLanguageChinese()?this._sysLang="zh":this._sysLang="en",this._sysLang="en")},n.Get=function(){let t=[];for(let e=0;e<arguments.length;e++)t[e]=arguments[e];if(0==t.length)throw new Error("LangUtil >> 参数个数不能为 0 个");let n=this._lang[this._sysLang][t[0]];void 0===n&&(n=t[0]);for(let e=1;e<t.length;++e){var i=new RegExp("\\{"+(e-1)+"\\}","gm");n=n.replace(i,t[e])}return n},n.AddLangCfg=function(t){let n;for(var i in this.InitSysLang(),t){this._lang[i]=null!==(n=this._lang[i])&&void 0!==n?n:{};let e=this._lang[i];var o,r=t[i];for(o in r)e[o]=r[o]}},n._sysLang="en",n._lang={},n._init=!1,n);function n(){}e.LangUtil=t}(numas=numas||{}),function(e){var t=(n.safeCall=function(e){null!=e&&e()},n.playParticleSystem=function(e,t){void 0===t&&(t=0),(e.node.opacity=0)==t?(e.resetSystem(),e.scheduleOnce(function(){e.node.opacity=255},0)):e.scheduleOnce(function(){e.resetSystem(),e.scheduleOnce(function(){e.node.opacity=255},0)},t)},n.block=function(r){return function(e,t,n){let i=n.value,o=!1;return n.value=function(){let t=[];for(let e=0;e<arguments.length;e++)t[e]=arguments[e];o?console.info("ii.Util.block >> blocking"):(o=!0,setTimeout(function(){o=!1},1e3*r),i.apply(this,t))},n}},n.onceCall=function(e,t){return function(){0==--t&&e()}},n.onceCallEx=function(t,n){return function(e){0==--n&&t(e)}},n);function n(){}e.Util=t}(numas=numas||{}),function(e){let t;(e=t=e.UIZIndex||(e.UIZIndex={}))[e.Stage=0]="Stage",e[e.Normal=128]="Normal",e[e.PopUp=256]="PopUp",e[e.TopModule=512]="TopModule",e[e.TopMsg=1024]="TopMsg",e[e.SystemModule=2048]="SystemModule"}(numas=numas||{}),function(e){e.IIStartPrefabCfg={dft:{panel:{DialogUIPanel:{key:"DialogUIPanel",z:e.UIZIndex.TopMsg},MsgUIPanel:{key:"MsgUIPanel",z:e.UIZIndex.SystemModule},BlockInputUIPanel:{key:"BlockInputUIPanel",z:e.UIZIndex.SystemModule},LoadingUIPanel:{key:"LoadingUIPanel",z:e.UIZIndex.SystemModule},WaitingUIPanel:{key:"WaitingUIPanel",z:e.UIZIndex.SystemModule}},comp:{}}}}(numas=numas||{}),function(e){var t=(n.dft={dialog_title:"default.dialog_title",dialog_lablel0_ok:"default.dialog_lablel0_ok",dialog_lablel_sure:"default.dialog_lablel_sure",dialog_lablel_cancel:"default.dialog_lablel_cancel",login_game:"default.login_game",login_fail_msg:"default.login_fail_msg",login_retry:"default.login_retry"},n);function n(){}e.LangCfg=t}(numas=numas||{}),function(l){var e=(c.Create1=function(e,t,n,i){void 0===n&&(n=l.LangCfg.dft.dialog_lablel0_ok),void 0===i&&(i=l.LangCfg.dft.dialog_title);let o=new c;return o.btnCount=1,o.msg=e,o.title=i,o.label0=n,o.btnFunc0=t,o},c.Create2=function(e,t,n,i,o,r){void 0===i&&(i=l.LangCfg.dft.dialog_lablel_cancel),void 0===o&&(o=l.LangCfg.dft.dialog_lablel_sure),void 0===r&&(r=l.LangCfg.dft.dialog_title);let s=new c;return s.btnCount=2,s.msg=e,s.title=r,s.label0=i,s.btnFunc0=t,s.label1=o,s.btnFunc1=n,s},c.Create3=function(e,t,n,i,o,r,s,u){void 0===o&&(o=l.LangCfg.dft.dialog_lablel_cancel),void 0===r&&(r=l.LangCfg.dft.dialog_lablel_sure),void 0===u&&(u=l.LangCfg.dft.dialog_title);let a=new c;return a.btnCount=3,a.msg=e,a.title=u,a.label0=o,a.btnFunc0=t,a.label1=r,a.btnFunc1=n,a.label2=null!=s?s:a.label2,a.btnFunc2=i,a},c);function c(){this.btnCount=1,this.msg="",this.title="",this.label0="",this.label1="",this.label2=""}l.DialogUIPanelArgs=e}(numas=numas||{}),(numas=numas||{})._LangCfg_DefaultJson={en:{"default.dialog_title":"Tip","default.dialog_lablel0_ok":"OK","default.dialog_lablel_sure":"SURE","default.dialog_lablel_cancel":"CANCEL","default.login_game":"Login","default.login_fail_msg":"Login Failed","default.login_retry":"Retry"},zh:{"default.dialog_title":"提示","default.dialog_lablel0_ok":"确定","default.dialog_lablel_sure":"确定","default.dialog_lablel_cancel":"取消","default.login_game":"登陆","default.login_fail_msg":"登陆失败","default.login_retry":"重试"}},function(o){var t,e=(t=cc.Component,__extends(n,t),n.prototype.onLoad=function(){var t=this;CC_DEBUG&&console.info(">> AudioMgr::onLoad"),null===n.ins?n.ins=this:this.destroy(),this.m_ToPlayEffectQueue=o.AnyQueue.Borrow(),this._effectOffBV=o.BooleanBV.BorrowAsLS("ls_effect_off",!1,!1),this._musicOffBV=o.BooleanBV.BorrowAsLS("ls_music_off",!1,!1).Bind(function(e){e?t.IsMusicPlaying()&&t.StopMusic():t.IsMusicPlaying()||t.playMusic(t.m_LastMusicKey)},!1,this)},n.prototype.SetHelper=function(e){this.m_AudioHelper=e},n.prototype.UseDefaultHelper=function(){this.SetHelper(new o.DefaultAudioHelper)},n.prototype.AddPlayEffect=function(t){this.m_ToPlayEffectQueue.Contains(function(e){return e==t})||(this.m_ToPlayEffectQueue.Enqueue(t),this.__i_StartScheduler())},n.prototype.ScheduleToPlayEffectQueue=function(){var t=this;0<this.m_ToPlayEffectQueue.Count&&(this.m_ToPlayEffectQueue.RemoveAll(function(e){return t.PlayEffect_Impl(e)}),this.__i_StopScheduler())},n.prototype.__i_StartScheduler=function(){null===this.m_PlayEffectScheduler&&(this.m_PlayEffectScheduler=this.ScheduleToPlayEffectQueue.bind(this),this.schedule(this.m_PlayEffectScheduler,0))},n.prototype.__i_StopScheduler=function(){null!==this.m_PlayEffectScheduler&&(this.unschedule(this.m_PlayEffectScheduler),this.m_PlayEffectScheduler=null)},n.prototype.SetDefaultEffect=function(e){null!=e&&""!==e&&(this.DEFAULT_EFFECT=e)},Object.defineProperty(n.prototype,"effectOffBV",{get:function(){return this._effectOffBV},enumerable:!1,configurable:!0}),n.prototype.PlayEffect=function(e){this._effectOffBV.v||(e=e||this.DEFAULT_EFFECT)&&o.ResMgr.ins.HasRegister(e)&&this.AddPlayEffect(e)},Object.defineProperty(n.prototype,"effectVolume",{get:function(){return this.m_AudioHelper.GetEffectVolume()},set:function(e){this.m_AudioHelper.SetEffectVolume(e)},enumerable:!1,configurable:!0}),n.prototype.PlayEffect_Impl=function(e){var n=this;o.ResMgr.ins.Load(e,function(e,t){n.m_AudioHelper.PlayEffect(e)})},Object.defineProperty(n.prototype,"musicOffBV",{get:function(){return this._musicOffBV},enumerable:!1,configurable:!0}),n.prototype.playMusic=function(e,n){var i=this;void 0===n&&(n=!0),e&&(this.m_LastMusicKey=e,this._musicOffBV.v||o.ResMgr.ins.Load(e,function(e,t){i.m_AudioHelper.PlayMusic(e,n)}))},n.prototype.IsMusicPlaying=function(){return this.m_AudioHelper.IsMusicPlaying()},n.prototype.PauseMusic=function(){this.m_AudioHelper.PauseMusic()},n.prototype.ResumeMusic=function(){this.m_AudioHelper.ResumeMusic()},n.prototype.StopMusic=function(){this.m_AudioHelper.StopMusic()},Object.defineProperty(n.prototype,"musicVolume",{get:function(){return this.m_AudioHelper.GetMusicVolume()},set:function(e){this.m_AudioHelper.SetMusicVolume(e)},enumerable:!1,configurable:!0}),n.ins=null,n);function n(){let e=null!==t&&t.apply(this,arguments)||this;return e.m_AudioHelper=null,e.m_ToPlayEffectQueue=null,e.m_PlayEffectScheduler=null,e.DEFAULT_EFFECT="audio.default_effect",e._effectOffBV=null,e._musicOffBV=null,e.m_LastMusicKey=null,e}o.AudioMgr=e}(numas=numas||{}),function(i){let n=(o.prototype.Reset=function(){(this.id=null)!==this.clip&&(this.clip.decRef(),this.clip=null)},o.Borrow=function(e,t){let n=i.ReferencePool.Borrow(o);return n.id=e,(n.clip=t).addRef(),n},o.prototype.Return=function(){i.ReferencePool.Return(o,this)},o);function o(){this.id=null,this.clip=null}var t,e=(t=cc.EventTarget,__extends(r,t),r.prototype.PlayEffect=function(e){var t=cc.audioEngine.playEffect(e,!1);cc.audioEngine.setVolume(t,this.GetEffectVolume()),this._effectQueue.Enqueue(n.Borrow(t,e)),this._effectQueue.Remove(function(e){return-1==cc.audioEngine.getState(e.id)},function(e){return e.Return()})},r.prototype.GetEffectVolume=function(){return cc.audioEngine.getEffectsVolume()},r.prototype.SetEffectVolume=function(e){0<=e&&e<=1&&cc.audioEngine.setEffectsVolume(e)},r.prototype.StopAllEffect=function(){cc.audioEngine.stopAllEffects(),this._effectQueue.RemoveAll(function(e){return e.Return()})},r.prototype.PlayMusic=function(e,t){this.m_MusicClip!=e&&(e.addRef(),0<=this.m_CurMusicId&&this.StopMusic(),this.m_MusicClip=e,this.m_CurMusicId=cc.audioEngine.playMusic(e,t),cc.audioEngine.setVolume(this.m_CurMusicId,this.GetMusicVolume()))},r.prototype.IsMusicPlaying=function(){return 0<=this.m_CurMusicId},r.prototype.PauseMusic=function(){cc.audioEngine.pauseMusic()},r.prototype.ResumeMusic=function(){cc.audioEngine.resumeMusic()},r.prototype.StopMusic=function(){0<=this.m_CurMusicId&&(cc.audioEngine.stop(this.m_CurMusicId),this.m_MusicClip.decRef(),this.m_MusicClip=null,this.m_CurMusicId=-1)},r.prototype.GetMusicVolume=function(){return cc.audioEngine.getMusicVolume()},r.prototype.SetMusicVolume=function(e){0<=e&&e<=1&&cc.audioEngine.setMusicVolume(e)},r);function r(){let e=null!==t&&t.apply(this,arguments)||this;return e._effectQueue=i.AnyQueue.Borrow(),e.m_CurMusicId=-1,e.m_MusicClip=null,e}i.DefaultAudioHelper=e}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),Object.defineProperty(i.prototype,"EventQueue",{get:function(){return null===this.m_EventQueue&&(this.m_EventQueue=e.AnyQueue.Borrow()),this.m_EventQueue},enumerable:!1,configurable:!0}),i.prototype.WrapEventHandler=function(t,n){var i=this;return function(e){i.m_IsEventHandlable?t.call(n,e):i.EventQueue.Enqueue(function(){return t.call(n,e)})}},i.prototype.HandleEvents=function(){if(this.m_IsEventHandlable=!0,null!==this.m_EventQueue)for(;0<this.m_EventQueue.Count;){let e=this.m_EventQueue.Dequeue();e()}},i.prototype.BlockEvents=function(){this.m_IsEventHandlable=!1},i.prototype.onDestroy=function(){null!==this.m_EventQueue&&(this.m_EventQueue.Return(),this.m_EventQueue=null)},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.m_IsEventHandlable=!1,e.m_EventQueue=null,e}e.DelayEventComponent=n}(numas=numas||{}),function(i){var e=(Object.defineProperty(t.prototype,"Count",{get:function(){return this.m_len},enumerable:!1,configurable:!0}),t.prototype.IndexOf=function(e){return this.__IndexOf(!0,e)},t.prototype.ReverseIndexOf=function(e){return this.__IndexOf(!1,e)},t.prototype.Fetch=function(e){return this.__Fetch(!0,e)},t.prototype.ReverseFetch=function(e){return this.__Fetch(!1,e)},t.prototype.FetchByIndex=function(e){return this.__FetchByIndex(!0,e)},t.prototype.ReverseFetchByIndex=function(e){return this.__FetchByIndex(!1,e)},t.prototype.Remove=function(e,t){this.__RemoveByFind(!0,e,t)},t.prototype.ReverseRemove=function(e,t){this.__RemoveByFind(!1,e,t)},t.prototype.RemoveFirst=function(e,t){this.__RemoveFirstByFind(!0,e,t)},t.prototype.ReverseRemoveFirst=function(e,t){this.__RemoveFirstByFind(!1,e,t)},t.prototype.RemoveAll=function(e){this.__RemoveByFind(!0,function(e){return!0},e)},t.prototype.ReverseRemoveAll=function(e){this.__RemoveByFind(!0,function(e){return!0},e)},t.prototype.For=function(e){return this.__For(!0,e)},t.prototype.ReverseFor=function(e){return this.__For(!1,e)},t.prototype.ForEach=function(e){this.__ForEach(!0,e)},t.prototype.ReverseForEach=function(e){this.__ForEach(!1,e)},t.prototype.CountIf=function(e){let t=0,n=this.m_front;for(;n.Next!=this.m_tail;)e(n.Next.Value)&&++t,n=n.Next;return t},t.prototype.Contains=function(e,t){let n=this.m_front;for(;n.Next!=this.m_tail;){if(e(n.Next.Value))return t&&t(n.Next.Value),!0;n=n.Next}return!1},t.prototype.FrontValue=function(){return this.m_front.Next.Value},t.prototype.TailValue=function(){return this.m_tail.Previous.Value},t.prototype.AddFront=function(e){this.AddNext(this.m_front,e)},t.prototype.AddTail=function(e){this.AddPrevious(this.m_tail,e)},t.prototype.Get=function(){if(0<this.Count)return this.RemoveNext(this.m_front);throw new Error("Ensure 'Count > 0' before Get!")},t.prototype.ReverseGet=function(){if(0<this.Count)return this.RemovePrevious(this.m_tail);throw new Error("Ensure 'Count > 0' before ReverseGet!")},t.prototype.Reset=function(){this.RemoveAll(),this.m_front.Next=this.m_tail,this.m_tail.Previous=this.m_front},t.prototype.AddNext=function(e,t){let n=i.LinkNode.Borrow();n.Value=t,n.Next=e.Next,(n.Previous=e).Next.Previous=n,e.Next=n,++this.m_len},t.prototype.AddPrevious=function(e,t){let n=i.LinkNode.Borrow();n.Value=t,n.Next=e,n.Previous=e.Previous,e.Previous.Next=n,e.Previous=n,++this.m_len},t.prototype.RemoveNext=function(e){var t=e.Next.Value;let n=e.Next;return(n.Next.Previous=e).Next=n.Next,--this.m_len,n.Return(),t},t.prototype.RemovePrevious=function(e){var t=e.Previous.Value;let n=e.Previous;return(n.Previous.Next=e).Previous=n.Previous,--this.m_len,n.Return(),t},t.prototype.__RemoveByFind=function(e,t,n){let i;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){var o;t(null===(i=e.Next)||void 0===i?void 0:i.Value)?(o=this.RemoveNext(e),n&&n(o)):e=e.Next}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){var r;t(e.Previous.Value)?(r=this.RemovePrevious(e),n&&n(r)):e=e.Previous}}},t.prototype.__RemoveFirstByFind=function(e,t,n){let i;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(null===(i=e.Next)||void 0===i?void 0:i.Value)){var o=this.RemoveNext(e);return void(n&&n(o))}e=e.Next}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value)){var r=this.RemovePrevious(e);return void(n&&n(r))}e=e.Previous}}},t.prototype.__IndexOf=function(e,t){let n=0;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(e.Next.Value))return n;e=e.Next,++n}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value))return n;e=e.Previous,++n}}return-1},t.prototype.__Fetch=function(e,t){let n=0;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(e.Next.Value))return e.Next.Value;e=e.Next,++n}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value))return e.Previous.Value;e=e.Previous,++n}}throw new Error("Can't Fetch target object")},t.prototype.__FetchByIndex=function(e,t){let n=0;if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(n==t)return e.Next.Value;e=e.Next,++n}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(n==t)return e.Previous.Value;e=e.Previous,++n}}throw new Error("Can't Fetch target object")},t.prototype.__For=function(e,t){if(e){let e=this.m_front;for(;e.Next!=this.m_tail;){if(t(e.Next.Value))return!0;e=e.Next}}else{let e=this.m_tail;for(;e.Previous!=this.m_front;){if(t(e.Previous.Value))return!0;e=e.Previous}}return!1},t.prototype.__ForEach=function(e,t){if(e){let e=this.m_front;for(;e.Next!=this.m_tail;)t(e.Next.Value),e=e.Next}else{let e=this.m_tail;for(;e.Previous!=this.m_front;)t(e.Previous.Value),e=e.Previous}},t);function t(){this.m_front=i.LinkNode.Borrow(),this.m_tail=i.LinkNode.Borrow(),this.m_len=0,this.m_front.Next=this.m_tail,this.m_tail.Previous=this.m_front}i.BaseLink=e}(numas=numas||{}),function(e){var t,n=(t=e.BaseLink,__extends(i,t),Object.defineProperty(i.prototype,"Front",{get:function(){return this.FrontValue()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Tail",{get:function(){return this.TailValue()},enumerable:!1,configurable:!0}),i.prototype.Enqueue=function(e){this.AddTail(e)},i.prototype.Dequeue=function(){return this.Get()},i.prototype.ReverseDequeue=function(){return this.ReverseGet()},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.Queue=n}(numas=numas||{}),function(e){var t,n=(t=e.Queue,__extends(i,t),i.Borrow=function(){return e.ReferencePool.Borrow(i)},i.prototype.Return=function(){e.ReferencePool.Return(i,this)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.AnyQueue=n}(numas=numas||{}),function(e){var t,n=(t=e.BaseLink,__extends(i,t),Object.defineProperty(i.prototype,"Top",{get:function(){return this.FrontValue()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"Bottom",{get:function(){return this.TailValue()},enumerable:!1,configurable:!0}),i.prototype.Push=function(e){this.AddFront(e)},i.prototype.Pop=function(){return this.Get()},i.prototype.ReversePop=function(){return this.ReverseGet()},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.Stack=n}(numas=numas||{}),function(e){var t,n=(t=e.Stack,__extends(i,t),i.Borrow=function(){return e.ReferencePool.Borrow(i)},i.prototype.Return=function(){e.ReferencePool.Return(i,this)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.AnyStack=n}(numas=numas||{}),function(e){var t=(n.prototype.left=function(e){return 2*e+1},n.prototype.right=function(e){return 2*e+2},n.prototype.parent=function(e){return e%2==0?(e-2)/2:(e-1)/2},n.prototype.Add=function(e){this.data.push(e),this.siftUp(this.data.length-1)},n.prototype.siftUp=function(e){let t,n=this.parent(e);for(;0<e&&0<this.m_Compare(this.data[n],this.data[e]);)t=[this.data[e],this.data[n]],this.data[n]=t[0],this.data[e]=t[1],e=n,n=this.parent(e)},n.prototype.ExtractRoot=function(){console.assert(0<this.data.length);var e=this.data[0],t=this.data.pop();return 0<this.data.length&&(this.data[0]=t,this.siftDown(0)),e},n.prototype.siftDown=function(e){let t;function n(e,t){return t>=i.data.length?e>=i.data.length?-1:e:i.m_Compare(i.data[e],i.data[t])<=0?e:t}var i=this;let o=n(this.left(e),this.right(e));for(;0<=o&&0<this.m_Compare(this.data[e],this.data[o]);)t=[this.data[e],this.data[o]],this.data[o]=t[0],this.data[e]=t[1],e=o,o=n(this.left(e),this.right(e))},Object.defineProperty(n.prototype,"Count",{get:function(){return this.data.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"Root",{get:function(){if(0<this.data.length)return this.data[0];throw new Error("Check Count before get Root")},enumerable:!1,configurable:!0}),n.prototype.Clear=function(){for(;0<this.data.length;)this.ExtractRoot()},n);function n(e){this.m_Compare=e,this.data=[]}e.Heap=t}(numas=numas||{}),function(n){var e=(i.prototype.Reset=function(){this.Next=null,this.Previous=null,this.Value=null},i.Borrow=function(e){void 0===e&&(e=null);let t=n.ReferencePool.Borrow(i);return t.Value=e,t},i.prototype.Return=function(){n.ReferencePool.Return(i,this)},i);function i(){this.Next=null,this.Previous=null}n.LinkNode=e}(numas=numas||{}),function(e){let t=(i.encode=function(e){if(/([^\u0000-\u00ff])/.test(e))throw new Error("INVALID_CHARACTER_ERR");let t=0,n,i,o,r=[];for(;t<e.length;){switch(i=e.charCodeAt(t),o=t%3,o){case 0:r.push(this.base64hash.charAt(i>>2));break;case 1:r.push(this.base64hash.charAt((3&n)<<4|i>>4));break;case 2:r.push(this.base64hash.charAt((15&n)<<2|i>>6)),r.push(this.base64hash.charAt(63&i))}n=i,t++}return 0==o?(r.push(this.base64hash.charAt((3&n)<<4)),r.push("==")):1==o&&(r.push(this.base64hash.charAt((15&n)<<2)),r.push("=")),r.join("")},i.decode=function(e){e=e.replace(/\s|=/g,"");let t,n,i,o=0,r=[];for(;o<e.length;){switch(t=this.base64hash.indexOf(e.charAt(o)),i=o%4,i){case 0:break;case 1:r.push(String.fromCharCode(n<<2|t>>4));break;case 2:r.push(String.fromCharCode((15&n)<<4|t>>2));break;case 3:r.push(String.fromCharCode((3&n)<<6|t))}n=t,o++}return r.join("")},i.Test=function(){console.log(">>Test Base64:");[{value:"Man",encode:"TWFu"},{value:"A",encode:"QQ=="},{value:"BC",encode:"QkM="}].forEach(function(e){var t=i.encode(e.value),n=i.decode(t);if(e.value!==n||t!==e.encode)throw"Error!";console.log(e.value," ----\x3e OK")})},i.base64hash="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i);function i(){}var n=(o.encodeBase64=function(e){return t.encode(e)},o.decodeBase64=function(e){return t.decode(e)},o);function o(){}e.encrypt=n}(numas=numas||{}),function(e){var t,n=(t=cc.EventTarget,__extends(i,t),Object.defineProperty(i,"ins",{get:function(){return null===this._ins&&(this._ins=new i),this._ins},enumerable:!1,configurable:!0}),i._ins=null,i);function i(){return t.call(this)||this}e.EventCenter=n}(numas=numas||{}),function(i){var e=(Object.defineProperty(t,"ins",{get:function(){return null===this._ins&&(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.save=function(){},t.prototype.deleteKey=function(e){cc.sys.localStorage.removeItem(e)},t.prototype.hasKey=function(e){e=cc.sys.localStorage.getItem(e);return null!=e&&0!=e.length},t.prototype.setBool=function(e,t,n){this.setItem(e,t?"t":"f",n)},t.prototype.getBool=function(e){return"t"==this.getItem(e)},t.prototype.getBoolWithDefault=function(e,t){return this.hasKey(e)?this.getBool(e):t},t.prototype.setInt=function(e,t,n){this.setItem(e,t.toString(),n)},t.prototype.getInt=function(e){return Number(this.getItem(e))},t.prototype.getIntWithDefault=function(e,t){return this.hasKey(e)?this.getInt(e):t},t.prototype.setString=function(e,t,n){this.setItem(e,t,n)},t.prototype.getString=function(e){return this.getItem(e)},t.prototype.getStringWithDefault=function(e,t){return this.hasKey(e)?this.getString(e):t},t.prototype.setObject=function(e,t,n){this.setItem(e,JSON.stringify(t),n)},t.prototype.getObject=function(e){return JSON.parse(this.getItem(e))},t.prototype.getObjectWithDefault=function(e,t){return this.hasKey(e)?this.getObject(e):t},t.prototype.getItem=function(e){let t=cc.sys.localStorage.getItem(e);return 0===t.indexOf(this.PRE_FIX)&&(t=t.substring(this.PRE_FIX.length),t=i.encrypt.decodeBase64(t)),t},t.prototype.setItem=function(e,t,n){cc.sys.localStorage.removeItem(e),CC_DEV||n&&(t=i.encrypt.encodeBase64(t),t=""+this.PRE_FIX+t),cc.sys.localStorage.setItem(e,t)},t._ins=null,t);function t(){this.PRE_FIX="#@!l0lzl(s_"}i.CocosLocalStorageHelper=e}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),i.prototype.onLoad=function(){CC_DEBUG&&console.info(">> LSMgr::onLoad"),null===i.ins?i.ins=this:this.destroy()},i.prototype.SetHelper=function(e){this.h=e},i.prototype.UseDefaultHelper=function(){this.SetHelper(e.CocosLocalStorageHelper.ins)},i.prototype.deleteKey=function(e){},i.prototype.hasKey=function(e){return this.h.hasKey(e)},i.prototype.setBool=function(e,t,n){this.h.setBool(e,t,n)},i.prototype.getBool=function(e){return this.h.getBool(e)},i.prototype.getBoolWithDefault=function(e,t){return this.h.getBoolWithDefault(e,t)},i.prototype.setInt=function(e,t,n){this.h.setInt(e,t,n)},i.prototype.getInt=function(e){return this.h.getInt(e)},i.prototype.getIntWithDefault=function(e,t){return this.h.getIntWithDefault(e,t)},i.prototype.setString=function(e,t,n){this.h.setString(e,t,n)},i.prototype.getString=function(e){return this.h.getString(e)},i.prototype.getStringWithDefault=function(e,t){return this.h.getStringWithDefault(e,t)},i.prototype.setObject=function(e,t,n){this.h.setObject(e,t,n)},i.prototype.getObject=function(e){return this.h.getObject(e)},i.prototype.getObjectWithDefault=function(e,t){return this.h.getObjectWithDefault(e,t)},i.ins=null,i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.h=null,e}e.LSMgr=n}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),i.prototype.onLoad=function(){CC_DEBUG&&console.info(">> UserLSMgr::onLoad"),null===i.ins?i.ins=this:this.destroy()},i.prototype.SetHelper=function(e){this.h=e},i.prototype.UseDefaultHelper=function(){this.SetHelper(e.CocosLocalStorageHelper.ins)},i.prototype.setUserId=function(e){console.warn("uid >> "+e),this.m_UserId=e},i.prototype.checkUserId=function(){if(null===this.m_UserId)throw new Error(">>>> please setUserId before use UserLSMgr")},i.prototype.key2UserKey=function(e){return this.m_UserId+"_"+e},i.prototype.deleteKey=function(e){},i.prototype.hasKey=function(e){return this.checkUserId(),this.h.hasKey(this.key2UserKey(e))},i.prototype.setBool=function(e,t,n){this.checkUserId(),this.h.setBool(this.key2UserKey(e),t,n)},i.prototype.getBool=function(e){return this.checkUserId(),this.h.getBool(this.key2UserKey(e))},i.prototype.getBoolWithDefault=function(e,t){return this.checkUserId(),this.h.getBoolWithDefault(this.key2UserKey(e),t)},i.prototype.setInt=function(e,t,n){this.checkUserId(),this.h.setInt(this.key2UserKey(e),t,n)},i.prototype.getInt=function(e){return this.checkUserId(),this.h.getInt(this.key2UserKey(e))},i.prototype.getIntWithDefault=function(e,t){return this.checkUserId(),this.h.getIntWithDefault(this.key2UserKey(e),t)},i.prototype.setString=function(e,t,n){this.checkUserId(),this.h.setString(this.key2UserKey(e),t,n)},i.prototype.getString=function(e){return this.checkUserId(),this.h.getString(this.key2UserKey(e))},i.prototype.getStringWithDefault=function(e,t){return this.checkUserId(),this.h.getStringWithDefault(this.key2UserKey(e),t)},i.prototype.setObject=function(e,t,n){this.checkUserId(),this.h.setObject(this.key2UserKey(e),t,n)},i.prototype.getObject=function(e){return this.checkUserId(),this.h.getObject(this.key2UserKey(e))},i.prototype.getObjectWithDefault=function(e,t){return this.checkUserId(),this.h.getObjectWithDefault(this.key2UserKey(e),t)},i.ins=null,i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.h=null,e.m_UserId=null,e}e.UserLSMgr=n}(numas=numas||{}),function(e){let n=(t.prototype.__C=function(e){let t=new cc.Node(this._k);return t.addComponent(e)},t.prototype.Get=function(e){if(0<this._p.length){let e=this._p.pop();return e.node.active=!0,e}return this.__C(e)},t.prototype.Put=function(e){e.node.active=!1,this._p.push(e)},t.prototype.Clear=function(){for(;0<this._p.length;){let e=this._p.pop();e.node.destroy()}},t);function t(e){this._p=[],this._k="",this._k=e}var i=(o.Get=function(e,t){let n=this.GetPool(e);return n.Get(t)},o.Put=function(e,t){let n=this.GetPool(e);n.Put(t)},o.GetPool=function(e){let t=null;return this._m.has(e)?t=this._m.get(e):(t=new n(e),this._m.set(e,t)),t},o._m=new Map,o);function o(){}e.NodePool=i}(numas=numas||{}),function(n){var e=(t.Debug=function(){console.warn(" -------- ReferencePool::Debug begin -------- "),console.info(this.s_ReferenceCollections),console.warn(" -------- ReferencePool::Debug end -------- ")},Object.defineProperty(t,"Count",{get:function(){return this.s_ReferenceCollections.size},enumerable:!1,configurable:!0}),t.ClearAll=function(){var n=this;this.s_ReferenceCollections.forEach(function(e,t){n.s_ReferenceCollections.delete(t),e.RemoveAll()})},t.Borrow=function(e){return this.GetReferenceCollection(e).Borrow()},t.Return=function(e,t){if(!t)throw new Error("Reference is invalid.");this.GetReferenceCollection(e).Return(t)},t.Add=function(e,t){this.GetReferenceCollection(e).Add(t)},t.Remove=function(e,t){this.GetReferenceCollection(e).Remove(t)},t.RemoveAll=function(e){let t;this.s_ReferenceCollections.has(e)&&(t=this.s_ReferenceCollections.get(e),t.RemoveAll(),this.s_ReferenceCollections.delete(e))},t.GetReferenceCollection=function(e){let t;return this.s_ReferenceCollections.has(e)?t=this.s_ReferenceCollections.get(e):(t=new n.ReferenceSinglePool(e),this.s_ReferenceCollections.set(e,t)),t},t.s_ReferenceCollections=new Map,t);function t(){}n.ReferencePool=e}(numas=numas||{}),function(e){var t=(Object.defineProperty(n.prototype,"UnusedReferenceCount",{get:function(){return this.m_References.length},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"UsingReferenceCount",{get:function(){return this.m_UsingReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"BorrowReferenceCount",{get:function(){return this.m_BorrowReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ReleaseReferenceCount",{get:function(){return this.m_ReleaseReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"AddReferenceCount",{get:function(){return this.m_AddReferenceCount},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"RemoveReferenceCount",{get:function(){return this.m_RemoveReferenceCount},enumerable:!1,configurable:!0}),n.prototype.Borrow=function(){return this.m_UsingReferenceCount++,this.m_BorrowReferenceCount++,0<this.m_References.length?this.m_References.pop():(this.m_AddReferenceCount++,new this.m_New)},n.prototype.Return=function(e){if(e.Reset(),-1!==this.m_References.indexOf(e))throw new Error("The reference has been released.");this.m_References.push(e),++this.m_ReleaseReferenceCount,--this.m_UsingReferenceCount},n.prototype.Add=function(e){for(this.m_AddReferenceCount+=e;0<e--;)this.m_References.push(new this.m_New)},n.prototype.Remove=function(e){for(e>this.m_References.length&&(e=this.m_References.length),this.m_RemoveReferenceCount+=e;0<e--;)this.m_References.pop()},n.prototype.RemoveAll=function(){this.Remove(this.m_References.length)},n);function n(e){this.m_References=[],this.m_UsingReferenceCount=0,this.m_BorrowReferenceCount=0,this.m_ReleaseReferenceCount=0,this.m_AddReferenceCount=0,this.m_RemoveReferenceCount=0,this.m_New=e,this.m_UsingReferenceCount=0,this.m_BorrowReferenceCount=0,this.m_ReleaseReferenceCount=0,this.m_AddReferenceCount=0,this.m_RemoveReferenceCount=0}e.ReferenceSinglePool=t}(numas=numas||{}),function(e){let t;function d(t,e,n,i,o,r){if(e)try{return e.apply(t,[n,i,o].concat(r))}catch(e){return t.error(n,i,o,r,y.Error.INVALID_CALLBACK,"an exception occurred in a caller-provided callback function",e)}}function _(e,t,n,i,o){var r,s,u,a,l;u=n,a=i,l=o,d(r=e,r["onafter"+(s=t)]||r["on"+s],s,u,a,l),t=t,n=n,i=i,o=o,d(e=e,e.onafterevent||e.onevent,t,n,i,o)}var y;(y=t=e.StateMachine||(e.StateMachine={})).VERSION="2.3.5",y.Result={SUCCEEDED:1,NOTRANSITION:2,CANCELLED:3,PENDING:4},y.Error={INVALID_TRANSITION:100,PENDING_TRANSITION:200,INVALID_CALLBACK:300},y.WILDCARD="*",y.ASYNC="async",y.create=function(e,t){let n="string"==typeof e.initial?{state:e.initial}:e.initial;var i=e.terminal||e.final;let o=t||e.target||{};var r,s,u=e.events||[];let a=e.callbacks||{},l={},c={};function p(t){var n=t.from instanceof Array?t.from:t.from?[t.from]:[y.WILDCARD];l[t.name]=l[t.name]||{};for(let e=0;e<n.length;e++)c[n[e]]=c[n[e]]||[],c[n[e]].push(t.name),l[t.name][n[e]]=t.to||n[e]}n&&(n.event=n.event||"startup",p({name:n.event,from:"none",to:n.state}));for(let e=0;e<u.length;e++)p(u[e]);for(r in l)l.hasOwnProperty(r)&&(o[r]=function(f,t){return function(){var l=this.current,c=t[l]||t[y.WILDCARD]||l,p=Array.prototype.slice.call(arguments);if(this.transition)return this.error(f,l,c,p,y.Error.PENDING_TRANSITION,"event "+f+" inappropriate because previous transition did not complete");if(this.cannot(f))return this.error(f,l,c,p,y.Error.INVALID_TRANSITION,"event "+f+" inappropriate in current state "+this.current);if(!1===function(e,t,n,i,o){if(!1===function(e,t,n,i,o){return d(e,e["onbefore"+t],t,n,i,o)}(e,t,n,i,o)||!1===function(e,t,n,i,o){return d(e,e.onbeforeevent,t,n,i,o)}(e,t,n,i,o))return!1}(this,f,l,c,p))return y.Result.CANCELLED;if(l===c)return _(this,f,l,c,p),y.Result.NOTRANSITION;var h=this;this.transition=function(){var n,i,t,o,e,r,s,u,a;return h.transition=null,h.current=c,n=f,i=l,o=p,function(e,t){d(e,e["onenter"+t]||e["on"+t],n,i,t,o)}(e=h,t=c),function(e){d(e,e.onenterstate||e.onstate,n,i,t,o)}(e),r=f,s=l,u=c,a=p,d(e=h,e.onchangestate,r,s,u,a),_(h,f,l,c,p),y.Result.SUCCEEDED},this.transition.cancel=function(){h.transition=null,_(h,f,l,c,p)};var e=function(e,t,n,i,o){var r=function(e,t,n,i,o){return d(e,e["onleave"+n],t,n,i,o)}(e,t,n,i,o),o=function(e,t,n,i,o){return d(e,e.onleavestate,t,n,i,o)}(e,t,n,i,o);{if(!1===r||!1===o)return!1;if(y.ASYNC===r||y.ASYNC===o)return y.ASYNC}}(this,f,l,c,p);return!1===e?(this.transition=null,y.Result.CANCELLED):y.ASYNC===e?y.Result.PENDING:this.transition?this.transition():void 0}}(r,l[r]));for(s in a)a.hasOwnProperty(s)&&(o[s]=a[s]);return o.current="none",o.is=function(e){return e instanceof Array?0<=e.indexOf(this.current):this.current===e},o.can=function(e){return!this.transition&&(l[e].hasOwnProperty(this.current)||l[e].hasOwnProperty(y.WILDCARD))},o.cannot=function(e){return!this.can(e)},o.transitions=function(){return c[this.current]},o.isFinished=function(){return this.is(i)},o.error=e.error||function(e,t,n,i,o,r,s){throw s||r},n&&!n.defer&&o[n.event](),o}}(numas=numas||{}),function(u){let e;!function(e){let t;(r=t=e.ETaskStatus||(e.ETaskStatus={}))[r.NONE=0]="NONE",r[r.RUNNING=1]="RUNNING",r[r.DONE=2]="DONE",r[r.ERROR=3]="ERROR";let n=(i.Borrow=function(e){return u.ReferencePool.Borrow(i).Init(e)},i.prototype.Reset=function(){this.m_Status=t.NONE,this.m_Func=null},i.prototype.Return=function(){u.ReferencePool.Return(i,this)},i.prototype.Init=function(e){return this.m_Func=e,this},i.prototype.Run=function(){return this.m_Status===t.NONE&&this.m_Func(this.Resolve.bind(this),this.Reject.bind(this)),this},i.prototype.Resolve=function(){this.m_Status=t.DONE},i.prototype.Reject=function(){this.m_Status=t.ERROR,console.warn("任务失败")},i.prototype.IsCompleted=function(){return this.m_Status===t.DONE},i);function i(){this.m_Func=null,this.m_Status=t.NONE}var o,r=(o=cc.Component,__extends(s,o),Object.defineProperty(s.prototype,"TaskQueue",{get:function(){return null===this._m_TaskQueue&&(this._m_TaskQueue=u.AnyQueue.Borrow()),this._m_TaskQueue},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"RunningTaskQueue",{get:function(){return null===this._m_RunningTaskQueue&&(this._m_RunningTaskQueue=u.AnyQueue.Borrow()),this._m_RunningTaskQueue},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"CallbackQueue",{get:function(){return null===this._m_CallbackQueue&&(this._m_CallbackQueue=u.AnyQueue.Borrow()),this._m_CallbackQueue},enumerable:!1,configurable:!0}),s.prototype.AddFunc=function(e){e=n.Borrow(e);return this.TaskQueue.Enqueue(e),this},s.prototype.Run=function(e,t){return null!=t&&this.CallbackQueue.Enqueue(t),this.StartTaskScheduler(e),this},s.prototype.RemoveSelf=function(){this.node.removeComponent(this)},s.prototype.StartTaskScheduler=function(t){var n=this;null===this.m_TaskScheduler&&(this.m_TaskScheduler=function(e){return n.UpdateLoading(t)},this.schedule(this.m_TaskScheduler,0,cc.macro.REPEAT_FOREVER,0))},s.prototype.StopTaskScheduler=function(){null!==this.m_TaskScheduler&&(this.unschedule(this.m_TaskScheduler),this.m_TaskScheduler=null)},s.prototype.UpdateLoading=function(e){for(;0<this.TaskQueue.Count;)if(this.RunningTaskQueue.Enqueue(this.TaskQueue.Dequeue().Run()),--e<=0)return;if(0<this.RunningTaskQueue.Count)this.RunningTaskQueue.Remove(function(e){return e.IsCompleted()},function(e){return e.Return()});else if(this.StopTaskScheduler(),null!==this.CallbackQueue)for(;0<this.CallbackQueue.Count;)this.CallbackQueue.Dequeue()()},s.prototype.onDestroy=function(){this.StopTaskScheduler(),null!==this._m_TaskQueue&&this._m_TaskQueue.Return(),null!==this._m_RunningTaskQueue&&this._m_RunningTaskQueue.Return(),null!==this._m_CallbackQueue&&this._m_CallbackQueue.Return()},s);function s(){let e=null!==o&&o.apply(this,arguments)||this;return e._m_TaskQueue=null,e._m_RunningTaskQueue=null,e.m_TaskScheduler=null,e._m_CallbackQueue=null,e}e.TaskComponent=r}(e=u.task||(u.task={}))}(numas=numas||{}),function(e){var t=(n.TimeStamp2Date=function(e){return new Date(1e3*e)},n.Date2TimeStamp=function(e){return Math.floor(e.getTime()/1e3)},n.getTimeStamp=function(){return Math.floor((new Date).getTime()/1e3)},n.getMilliTimeStamp=function(){return(new Date).getTime()},n.IsSameDay=function(e,t){return e.toDateString()===t.toDateString()},n.IsSameDayTimeStamp=function(e,t){return this.IsSameDay(this.TimeStamp2Date(e),this.TimeStamp2Date(t))},n.zeroHourOfTimeStamp=function(e){return this.zeroHourTimeStampOfDate(this.TimeStamp2Date(e))},n.zeroHourTimeStampOfDate=function(e){return this.Date2TimeStamp(e)-(3600*e.getHours()+60*e.getMinutes()+e.getSeconds())},n.tomorrowTimeStamp=function(e){return this.zeroHourOfTimeStamp(e+86400)},n.tomorrowTimeStampOfDate=function(e){return this.tomorrowTimeStamp(this.Date2TimeStamp(e))},n.IsToday=function(e){return this.IsSameDayTimeStamp(e,this.getTimeStamp())},n.IsBeforToday=function(e){return!this.IsToday(e)&&e<this.getTimeStamp()},n.Format=function(e,t,n){var i,o;return void 0===t&&(t="hh:mm:ss"),void 0===n&&(n=!1),-1!=t.indexOf("dd")&&(e-=86400*(i=Math.floor(e/86400)),i=n||9<i?""+i:"0"+i,t=t.replace("dd",i)),-1!=t.indexOf("hh")&&(e-=3600*(o=Math.floor(e/3600)),o=n||9<o?""+o:"0"+o,t=t.replace("hh",o)),-1!=t.indexOf("mm")&&(e-=60*(o=Math.floor(e/60)),o=n||9<o?""+o:"0"+o,t=t.replace("mm",o)),-1!=t.indexOf("ss")&&(e=Math.floor(e),e=n||9<e?""+e:"0"+e,t=t.replace("ss",e)),t},n);function n(){}e.date=t}(numas=numas||{}),function(e){let t;(e=t=e.Dir||(e.Dir={}))[e.Right=0]="Right",e[e.Top=1]="Top",e[e.Left=2]="Left",e[e.Bottom=3]="Bottom"}(numas=numas||{}),function(t){var n,e=(n=t.BaseUIComp,__extends(i,n),i.prototype.GetUPH=function(){return this._$uph_},i.prototype.GetResKey=function(){return this._$uph_.GetResKey()},i.prototype.$__i_InitByUPH=function(e){this._$uph_=e,this.OnCreate()},i.prototype.$__i_CloseByUPH=function(){this._$isOpening_?console.error("UIPanel >> Open "+this.name+" 时调用了关闭，这是不允许的逻辑"):(this._$isOpened_=!1,this.OnRelease(),this.__i_CloseAllAutoCloseUIComp())},i.prototype.$__i_OnOpen=function(e){this._$isOpened_?console.error("UIPanel >> 已经处于打开状态，不应该重复调用此方法"):(this._$isOpened_=!0,this._$isOpening_=!0,this.args=e,this.OnOpen(e),this._$isOpening_=!1)},i.prototype.Close=function(){this.TryNotifyGuideEvent(),t.UIMgr.ins.Close(this)},i.prototype.BindBV=function(e,t,n){e.Bind(t,n,this),this._m_BVList_.push(e)},i.prototype.UnbindAllBV=function(){for(;0<this._m_BVList_.length;)this._m_BVList_.pop().TargetUnbind(this)},i.prototype.onDestroy=function(){this._$isOpened_&&console.warn("不规范的调用方式 >> 未调用 "+this.name+".Close() 方法进行对象的移除"),this.UnbindAllBV(),this.__i_CloseAllAutoCloseUIComp(),n.prototype.onDestroy.call(this)},i.prototype.SetGuideNotificationActive=function(e){this._guideNotify=e},i.prototype.TryNotifyGuideEvent=function(){var e;this._guideNotify&&(e="guide.ui.close."+this.GetResKey(),console.info("引导 >> 全局关闭消息 >> 派发 "+e),t.EventCenter.ins.emit(e))},i.prototype.__i_AutoCloseUIComp=function(e){return this._I_AutoCloseUICompQueue.Enqueue(e),e},Object.defineProperty(i.prototype,"_I_AutoCloseUICompQueue",{get:function(){return null===this._i_UICompQueue&&(this._i_UICompQueue=t.AnyQueue.Borrow()),this._i_UICompQueue},enumerable:!1,configurable:!0}),i.prototype.__i_CloseAllAutoCloseUIComp=function(){null!==this._i_UICompQueue&&(this._i_UICompQueue.RemoveAll(function(e){return e.Close()}),this._i_UICompQueue.Return(),this._i_UICompQueue=null)},i);function i(){let e=null!==n&&n.apply(this,arguments)||this;return e.args=null,e._$isOpened_=!1,e._$isOpening_=!1,e._$uph_=null,e._m_BVList_=[],e._guideNotify=!1,e._i_UICompQueue=null,e}t.UIPanel=e}(numas=numas||{}),function(l){let e;!function(e){e.Event={DRAG_START:"ii.guide.DRAG_START",DRAG_END:"ii.guide.DRAG_END"},e.ActionType={fade:"fade",up_down:"up_down"},e.PositionType={related_to_node_id:"related_to_node_id"};let t=(Object.defineProperty(n.prototype,"NextStep",{get:function(){return this.m_NextStepOnceFunc},enumerable:!1,configurable:!0}),n.prototype.GetV=function(t){for(let e=0;e<this.m_Data.kv.length;++e)if(this.m_Data.kv[e].k==t)return this.m_Data.kv[e].v;console.error('[Error] k: "'+t+'" has no config in "'+this.typ+"\"'s kv")},n.prototype.GetVWithDefault=function(t,e){for(let e=0;e<this.m_Data.kv.length;++e)if(this.m_Data.kv[e].k==t)return this.m_Data.kv[e].v;return e},Object.defineProperty(n.prototype,"typ",{get:function(){return this.m_Data.typ},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"kv",{get:function(){return this.m_Data.kv},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"args",{get:function(){return this.GetVWithDefault("args",null)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"click_bg",{get:function(){return this.GetVWithDefault("click_bg",!1)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"color",{get:function(){return this.GetVWithDefault("color",0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"col_row",{get:function(){return this.GetV("col_row")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dir",{get:function(){return this.GetV("dir")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dx",{get:function(){return this.GetV("dx")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"dy",{get:function(){return this.GetV("dy")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"enter_action",{get:function(){return this.GetV("enter_action")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"exit_action",{get:function(){return this.GetV("exit_action")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"path_action",{get:function(){return this.GetV("path_action")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.GetV("position")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"res_key",{get:function(){return this.GetVWithDefault("res_key",null)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"text",{get:function(){return this.GetV("text")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"time",{get:function(){return this.GetV("time")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tiles",{get:function(){return this.GetV("tiles")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"node_id",{get:function(){return this.GetV("node_id")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"next_step_event",{get:function(){return this.GetV("next_step_event")},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this.GetVWithDefault("x",0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.GetVWithDefault("y",0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"z",{get:function(){return this.GetVWithDefault("z",0)},enumerable:!1,configurable:!0}),n.prototype.GetNodePosition=function(e,t){return this.m_Helper.GetNodePosition(e,t)},n.prototype.CheckColRow=function(e){if("check_col_row"!==this.typ)return!1;var t=this.col_row,e=t.col==e.col&&t.row==e.row;return e&&this.NextStep(),e},n);function n(e,t,n){this.m_Data=null,this.m_Helper=null,this.m_NextStepOnceFunc=null,this.m_Data=e,this.m_Helper=t,this.m_NextStepOnceFunc=n}e.Step=t;let o=(i.Run=function(e,t,n){switch(t.typ){case"fade":return this.RunFadeAction(e,t,n);case"up_down":return this.RunUpDownAction(e,t);default:throw new Error("未处理的动作类型 "+t.typ)}},i.RunFadeAction=function(e,t,n){return e.opacity=t.from,cc.tween(e).delay(t.delay).to(t.duration,{opacity:t.to}).call(function(){return l.Util.safeCall(n)}).start()},i.RunUpDownAction=function(e,t){e.position=new cc.Vec3(e.position.x,t.from,e.position.z);t=cc.tween(e).to(t.duration,{y:t.to}).to(t.duration,{y:t.from}).to(t.duration,{y:t.to}).to(t.duration,{y:t.from}).delay(t.delay);return cc.tween(e).repeatForever(t).start()},i);function i(){}e.ActionUtil=o;var r,s=(r=l.UIPanel,__extends(u,r),Object.defineProperty(u.prototype,"Delegate",{get:function(){return this.args.delegate},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"stepDatas",{get:function(){return this.args.guideData.steps},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"Step",{get:function(){return this._step},enumerable:!1,configurable:!0}),u.prototype.OnCreate=function(){this.Background.opacity=0,this.OnCreateSelf(),l.EventCenter.ins.on(e.Event.DRAG_START,this.Finger.OnDragStart.bind(this.Finger),this),l.EventCenter.ins.on(e.Event.DRAG_END,this.Finger.OnDragEnd.bind(this.Finger),this)},u.prototype.OnOpen=function(e){var t=this;(this.args.guideCtrl.GuidePlayer=this).SetBackgroundClickHandler(function(){null!=t.m_OnBackgroundClick_&&(l.AudioMgr.ins.PlayEffect(),t.m_OnBackgroundClick_())}),this.OnOpenSelf(),this._bInitNextStep=!0,this.nextStep()},u.prototype.OnRelease=function(){this.OnReleaseSelf()},u.prototype.onDestroy=function(){l.EventCenter.ins.targetOff(this),this.m_NodeParentMap.clear(),this.m_NodeParentMap=null,r.prototype.onDestroy.call(this)},u.prototype.nextStep=function(){if(this._bInitNextStep){if(this._stepIndex+1>=this.stepDatas.length)return this.Delegate.OnGuideFinished(),this.args.onCompleted(),void this.Close();++this._stepIndex;var e=this.stepDatas[this._stepIndex];this._step=new t(e,this,l.Util.onceCall(this.nextStep.bind(this),1)),this.__doStep(this._step)}else console.error("只能在 OnOpen 之后调用 nextStep")},u.prototype.__doStep=function(t){var e=this;switch(t.typ){case"delay":this.scheduleOnce(t.NextStep,t.time);break;case"transfer":{var n=t.node_id;let e=this.Delegate.OnGuideGetNode(n);this.m_NodeParentMap.set(n,e.parent),l.UIUtil.transferTo(e,this.TransferRoot,!1),e.zIndex=t.z,t.NextStep()}break;case"transfer_back":var i=t.node_id,n=this.Delegate.OnGuideGetNode(i);l.UIUtil.transferTo(n,this.m_NodeParentMap.get(i),!1),t.NextStep();break;case"show_bg":this.Background.opacity=0,o.Run(this.Background,t.enter_action,t.NextStep);break;case"hide_bg":o.Run(this.Background,t.exit_action,t.NextStep);break;case"dialog":i=l.Util.onceCall(function(){e.m_OnBackgroundClick_=null,e.Dialog.node.active=!1,t.NextStep()},1);t.click_bg&&(this.m_OnBackgroundClick_=i),this.Dialog.node.active=!0,this.Dialog.node.position=this.GetNodePosition(this.Dialog.node,t.position),this.Dialog.Show(t,i);break;case"finger":this.Finger.node.active=!0,this.Finger.Show(t),t.NextStep();break;case"hide_finger":this.Finger.Hide(),t.NextStep();break;case"open_ui":l.EventCenter.ins.once(t.next_step_event,function(){console.info("引导 >> 全局关闭消息 >> 处理 "+t.next_step_event),t.NextStep()},this),l.UIMgr.ins.Open(t.res_key,t.args);break;case"audio":l.AudioMgr.ins.PlayEffect(t.res_key),t.NextStep();break;default:this.Delegate.OnGuideStep(t)}},u.prototype.GetNodePosition=function(t,n){if("related_to_node_id"===n.typ){let e=this.Delegate.OnGuideGetNode(n.node_id);var i=new cc.Vec3(e.position.x+n.dx,e.position.y+n.dy,e.position.z);return t.parent.convertToNodeSpaceAR(e.parent.convertToWorldSpaceAR(i))}console.error("Guide >> 未处理的位置类型 typ = "+n.typ)},u);function u(){let e=null!==r&&r.apply(this,arguments)||this;return e._stepIndex=-1,e._bInitNextStep=!1,e._step=null,e.m_OnBackgroundClick_=null,e.m_NodeParentMap=new Map,e}function a(e,t){this._guideKey=null,this._delegate=null,this._guidePlayer=null,this._guideKey=e,this._delegate=t}e.GuidePlayerUIPanel=s,a.GetIsGuiding=function(e){return!!this._playingDict.has(e)&&this._playingDict.get(e)},a.SetIsGuiding=function(e,t){this._playingDict.set(e,t)},a.Create=function(e,t){return new a(e,t)},a.prototype.Release=function(){},a.prototype.IsGuided=function(){return l.UserLSMgr.ins.getBoolWithDefault(this._guideKey,!1)},Object.defineProperty(a.prototype,"IsGuiding",{get:function(){return a.GetIsGuiding(this._guideKey)},enumerable:!1,configurable:!0}),a.prototype.StartGuide=function(e,t){console.assert(!this.IsGuiding,"错误的调用逻辑 >> 已经在播放引导了！"),a.SetIsGuiding(this._guideKey,!0),l.UIMgr.ins.Open(e,{guideCtrl:this,delegate:this._delegate,guideData:t,onCompleted:this.FinishGuide.bind(this)})},a.prototype.FinishGuide=function(){a.SetIsGuiding(this._guideKey,!1),l.UserLSMgr.ins.setBool(this._guideKey,!0,!0)},Object.defineProperty(a.prototype,"GuidePlayer",{get:function(){return this._guidePlayer},set:function(e){this._guidePlayer=e},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"Step",{get:function(){return this._guidePlayer.Step},enumerable:!1,configurable:!0}),a._playingDict=new Map,s=a,e.GuideCtrl=s}(e=l.guide||(l.guide={}))}(numas=numas||{}),function(e){var t=(n.Borrow=function(){return e.ReferencePool.Borrow(n)},n.prototype.Return=function(){e.ReferencePool.Return(n,this)},n.prototype.Reset=function(){},n.prototype.Init=function(e,t){return this.col=e,this.row=t,this},n);function n(){this.col=0,this.row=0}e.Tile=t}(numas=numas||{}),function(e){var t=(n.xxxx=function(){},n);function n(){}e.HttpUtil=t}(numas=numas||{}),function(e){var t=(n.Get=function(e,t,n,i){this.request(e,t,"GET",n,i)},n.Post=function(e,t,n,i){this.request(e,t,"POST",n,i)},n.request=function(n,i,e,o,t){window.wx.request({url:n,data:i,header:{"content-type":"application/json"},method:e,success:function(e){var t;CC_DEBUG&&(t=n.substr(n.lastIndexOf("/")),console.debug("uri=="+t,"resp --",JSON.stringify(e.data),", req --",i)),o(e.data)},fail:function(e){t(e)}})},n);function n(){}e.HttpWeChatUtil=t}(numas=numas||{}),function(e){var t=(n.IsWifi=function(){return cc.sys.getNetworkType()==cc.sys.NetworkType.LAN},n);function n(){}e.NetUtil=t}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnOpen=function(e){this.OnOpenLoadingAD(e)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.ALoadingADUIPanel=n}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"IsiOS",{get:function(){return cc.sys.platform==cc.sys.IPHONE||cc.sys.platform==cc.sys.IPAD},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsWechat",{get:function(){return cc.sys.platform===cc.sys.WECHAT_GAME},enumerable:!1,configurable:!0}),n.OpenAppStore=function(e){this.IsiOS&&cc.sys.openURL("itms-apps://itunes.apple.com/app/id"+e.iOS.AppId)},n);function n(){}e.PlatformUtil=t}(numas=numas||{}),function(e){var t,n=(t=e.BaseComp,__extends(i,t),i.prototype.Init=function(e){if(this._isInit)throw new Error("SDKBase >> 重复的初始化！");return this.sdkCfg=e,this.OnInit(e),this},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._isInit=!1,e.sdkCfg=null,e}e.SDKBase=n}(numas=numas||{}),function(s){var t,e=(t=s.SDKBase,__extends(n,t),n.prototype.IsInitByScript=function(){return this.m_InitByScript},n.prototype.InitByScript=function(){this.m_InitByScript||(this.m_InitByScript=!0,this.InitByScriptImpl(),this.__i_StartADTick())},n.prototype.ShowBanner=function(e){this.m_InitByScript&&(this.IsAdRemoved()||this.ShowBannerImpl(e))},n.prototype.IsInterstitialAvailable=function(){return!!this.m_InitByScript&&this.IsInterstitialAvailableImpl()},n.prototype.LoadInterstitial=function(){this.m_InitByScript&&this.LoadInterstitialImpl()},n.prototype.LoadInterstitialIfNotAvalable=function(){this.IsAdRemoved()||this.IsInterstitialAvailable()||this.LoadInterstitial()},n.prototype.ShowInterstitialWithBlocker=function(e,t,n){var i=this;this.IsAdRemoved()?s.Util.safeCall(e):this.IsInterstitialAvailable()?s.UIMgr.ins.Open(t,{duration:n,cb:function(){return i.__ShowInterstitial(e)}}):(this.LoadInterstitialIfNotAvalable(),s.Util.safeCall(e))},n.prototype.ShowInterstitial=function(e){this.IsAdRemoved()?s.Util.safeCall(e):this.IsInterstitialAvailable()?this.__ShowInterstitial(e):(this.LoadInterstitialIfNotAvalable(),s.Util.safeCall(e))},n.prototype.__ShowInterstitial=function(e){var t=this;let n=s.Util.onceCall(function(){s.Util.safeCall(e),t.LoadInterstitialIfNotAvalable()},1);this.ShowInterstitialImpl(function(e){switch(e){case s.EInterstitial.NOT_AVAILABLE:case s.EInterstitial.SHOW_ERROR:case s.EInterstitial.HIDE:n()}})},n.prototype.IsRewardedVideoAvailable=function(){return!!this.m_InitByScript&&this.IsRewardedVideoAvailableImpl()},n.prototype.ShowRewardedVideo=function(e){if(this.IsRewardedVideoAvailable()){let n=s.Util.onceCall(e,2);this.ShowRewardedVideoImpl(function(e,t){switch(e){case s.EInternalRewardedVideo.REWARDED:case s.EInternalRewardedVideo.HIDE:t&&n()}})}},n.prototype.ShowRewardedVideoEx=function(o){var r=this;if(this.IsRewardedVideoAvailable()){this.m_Tmp_IsReceivedRewardedEvent=!1,this.m_Tmp_IsReceivedHideEvent=!1;let n=s.Util.onceCall(function(){return o(s.ERewardedVideo.NOT_AVAILABLE,!1)},1),i=s.Util.onceCallEx(function(e){return o(s.ERewardedVideo.HIDE,e)},1);this.ShowRewardedVideoImpl(function(e,t){switch(e){case s.EInternalRewardedVideo.NOT_AVAILABLE:case s.EInternalRewardedVideo.SHOW_ERROR:n();break;case s.EInternalRewardedVideo.SHOW:o(s.ERewardedVideo.SHOW,!1);break;case s.EInternalRewardedVideo.HIDE:r.m_Tmp_IsReceivedRewardedEvent?i(t):(r.m_Tmp_IsReceivedHideEvent=!0,t?i(t):r.scheduleOnce(function(){i(t)},.05));break;case s.EInternalRewardedVideo.REWARDED:r.m_Tmp_IsReceivedHideEvent?i(t):r.m_Tmp_IsReceivedRewardedEvent=!0}})}else o(s.ERewardedVideo.NOT_AVAILABLE,!1)},n.prototype.RemoveAdsForSeconds=function(e){this.IsAdRemoved()||this.ShowBanner(!1),this.RemoveAdsSecondsBV.v+=e,this.__i_StartADTick()},n.prototype.__i_StartADTick=function(){0<this.RemoveAdsSecondsBV.v&&this.StartScheduler("__I_AD_TICK",this.__I_AD_TICK.bind(this),1,cc.macro.REPEAT_FOREVER)},n.prototype.__I_AD_TICK=function(){--this.RemoveAdsSecondsBV.v,0===this.RemoveAdsSecondsBV.v&&this.StopScheduler("__I_AD_TICK")},n.prototype.IsAdRemoved=function(){return 0<this.RemoveAdsSecondsBV.v},n);function n(){let e=null!==t&&t.apply(this,arguments)||this;return e.RewardedVideoBV=s.BooleanBV.Borrow(!1),e.RemoveAdsSecondsBV=s.NumberBV.BorrowAsLS("ls_remove_ads_seconds",0,!0),e.m_InitByScript=!1,e.m_Tmp_IsReceivedRewardedEvent=!1,e.m_Tmp_IsReceivedHideEvent=!1,e}s.ADBase=e}(numas=numas||{}),function(e){var t,n=(t=cc.Component,__extends(i,t),i.prototype.Init=function(e){if(this._isInit)throw new Error("PlatformBase >> 重复的初始化！");return this.sdkCfg=e,this._user=this.addComponent(this.GetUserClass()),this._user.Init(this.sdkCfg),this._ad=this.addComponent(this.GetADClass()),this._ad.Init(this.sdkCfg),this._vibrate=this.addComponent(this.GetVibrateClass()),this._vibrate.Init(this.sdkCfg),this},Object.defineProperty(i.prototype,"user",{get:function(){return this._user},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"ad",{get:function(){return this._ad},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"vibrate",{get:function(){return this._vibrate},enumerable:!1,configurable:!0}),i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._isInit=!1,e.sdkCfg=null,e._user=null,e._ad=null,e._vibrate=null,e}e.PlatformBase=n}(numas=numas||{}),function(o){var t,e=(t=o.SDKBase,__extends(n,t),n.prototype.OnInit=function(e){this.UserDefaultServerLoginHelper()},Object.defineProperty(n.prototype,"uid",{get:function(){return this.m_UserId},enumerable:!1,configurable:!0}),n.prototype.UserDefaultServerLoginHelper=function(){this._serverLoginHelper=new o.DefaultServerLoginHelper},n.prototype.LoginServer=function(e,t){var n=this;this._serverLoginHelper?this._serverLoginHelper.Login(e,function(e){CC_DEBUG&&(e.success?console.info("登陆游戏服务器成功！>> uid: "+e.uid):console.info("登陆游戏服务器失败！>> error: "+e.error)),n.m_UserId=e.success?e.uid:o.Cfg.DefaultUserKey,o.UserLSMgr.ins.setUserId(n.uid),e.success?(n.StartGameTimeScheduler(),n.OnLoginServerSuccess()):(n.StopGameSimeScheduler(),n.OnLoginServerFailed()),t(e)}):console.error("UserBase::Login >> 请先使用 SetHelper(loginHelper: IServerLoginHelper) 设置 IServerLoginHelper")},n.prototype.Key2UserKey=function(e,t){return e+"_"+t},n.prototype.DevKey2RealKey=function(e){return o.CfgUtil.k2v(this.GetGameCenterCfg().Ranks,e)},n.prototype.RealKey2DevKey=function(e){return o.CfgUtil.v2k(this.GetGameCenterCfg().Ranks,e)},n.prototype.GetGameCenterBV=function(t,n){var i=this,t=this.Key2UserKey(t,n);if(this.m_Dict.has(t))return this.m_Dict.get(t);{let e=o.MaxNumberBV.BorrowAsLS(t,0,!0);return this.m_Dict.set(t,e),e.Bind(function(e){i.ReportScoreWithDevKey(n,e)},!1,this),e}},n.prototype.ReportScoreWithDevKey=function(e,t){this.ReportScore(this.DevKey2RealKey(e),t)},n.prototype.GetGameCenterVal=function(e){return this.GetGameCenterBV(this.uid,e).v},n.prototype.SetGameCenterVal=function(e,t){this.GetGameCenterBV(this.uid,e).v=t},n.prototype.UploadGameTime=function(){null!==this.m_ToUploadGameTimeLS&&0<this.m_ToUploadGameTimeLS.v&&(this.SetGameCenterVal("GameTime",this.GetGameCenterVal("GameTime")+this.m_ToUploadGameTimeLS.v),this.m_ToUploadGameTimeLS.v=0)},n.prototype.StartGameTimeScheduler=function(){null===this.m_GameTimeScheduler&&(this.m_GameTimeScheduler=this.GameTimeTick.bind(this),this.m_ToUploadGameTimeLS=o.NumberBV.BorrowAsUserLS("ii_user_touploadtime",0,!0),this.schedule(this.m_GameTimeScheduler,this.TIME_INC_INTERVAL,cc.macro.REPEAT_FOREVER))},n.prototype.StopGameSimeScheduler=function(){var e;null!==this.m_GameTimeScheduler&&(e=this.m_GameTimeScheduler,this.m_GameTimeScheduler=null,this.unschedule(e),null!==this.m_ToUploadGameTimeLS&&this.m_ToUploadGameTimeLS.Return())},n.prototype.GameTimeTick=function(){this.m_ToUploadGameTimeLS.v+=this.TIME_INC_INTERVAL,59<=this.m_ToUploadGameTimeLS.v&&this.UploadGameTime()},n);function n(){let e=null!==t&&t.apply(this,arguments)||this;return e.m_UserId=o.Cfg.DefaultUserKey,e._serverLoginHelper=null,e.m_Dict=new Map,e.m_ToUploadGameTimeLS=null,e.m_GameTimeScheduler=null,e.TIME_INC_INTERVAL=7,e}o.UserBase=e}(numas=numas||{}),function(t){var n,e=(n=t.SDKBase,__extends(i,n),Object.defineProperty(i.prototype,"off",{get:function(){return this._off},enumerable:!1,configurable:!0}),i.prototype.Toggle=function(){return this._off.v=!this._off.v,this._off.v},i.prototype.OnInit=function(e){this._off=t.BooleanBV.BorrowAsLS("ll_vibrate_off",!1,!1)},i.prototype.Default=function(){this._off.v||this.DefaultImpl()},i);function i(){let e=null!==n&&n.apply(this,arguments)||this;return e._off=null,e}t.VibrateBase=e}(numas=numas||{}),function(e){var t=(n.k2v=function(t,n){if(null!=t)for(let e=t.length-1;0<=e;--e)if(t[e].k===n)return t[e].v;return null},n.v2k=function(t,n){if(null!=t)for(let e=t.length-1;0<=e;--e)if(t[e].v===n)return t[e].k;return null},n);function n(){}e.CfgUtil=t}(numas=numas||{}),function(e){let t;var n;(n=t=e.EInterstitial||(e.EInterstitial={}))[n.NOT_AVAILABLE=0]="NOT_AVAILABLE",n[n.LOAD_ERROR=1]="LOAD_ERROR",n[n.SHOW=2]="SHOW",n[n.SHOW_ERROR=3]="SHOW_ERROR",n[n.CLICK=4]="CLICK",n[n.HIDE=5]="HIDE";let i;(n=i=e.EInternalRewardedVideo||(e.EInternalRewardedVideo={}))[n.NOT_AVAILABLE=0]="NOT_AVAILABLE",n[n.SHOW_ERROR=1]="SHOW_ERROR",n[n.SHOW=2]="SHOW",n[n.HIDE=3]="HIDE",n[n.REWARDED=4]="REWARDED";let o;(e=o=e.ERewardedVideo||(e.ERewardedVideo={}))[e.NOT_AVAILABLE=0]="NOT_AVAILABLE",e[e.SHOW=1]="SHOW",e[e.HIDE=2]="HIDE"}(numas=numas||{}),function(e){var t=(n.prototype.Login=function(e,t){CC_DEBUG&&console.info("DefaultServerLoginHelper >> 使用默认游戏登录器进行登陆"),setTimeout(function(){t({success:!0,uid:e.openid})},.1)},n);function n(){}e.DefaultServerLoginHelper=t}(numas=numas||{}),function(e){var t,n="org/cocos2dx/javascript/NMProxyAD",i=(t=e.ADBase,__extends(o,t),o.prototype.IsSupport=function(){return!0},o.prototype.InitByScriptImpl=function(){jsb.reflection.callStaticMethod(n,"initByScript","()V")},o.prototype.OnInit=function(){},o.prototype.ShowBannerImpl=function(e){e?jsb.reflection.callStaticMethod(n,"ShowBanner","()V"):jsb.reflection.callStaticMethod(n,"HideBanner","()V")},o.prototype.DestroyBanner=function(){jsb.reflection.callStaticMethod(n,"DestroyBanner","()V")},o.prototype.IsInterstitialAvailableImpl=function(){return jsb.reflection.callStaticMethod(n,"IsInterstitialAvailable","()Z")},o.prototype.LoadInterstitialImpl=function(){jsb.reflection.callStaticMethod(n,"LoadInterstitial","()V")},o.prototype.ShowInterstitialImpl=function(e){jsb.reflection.callStaticMethod(n,"ShowInterstitial","()V")},o.prototype.IsRewardedVideoAvailableImpl=function(){return jsb.reflection.callStaticMethod(n,"IsRewardedVideoAvailable","()Z")},o.prototype.ShowRewardedVideoImpl=function(e){jsb.reflection.callStaticMethod(n,"ShowRewardedVideo","()V")},o);function o(){return null!==t&&t.apply(this,arguments)||this}e.AndroidIronSource=i}(numas=numas||{}),function(n){var t,e=(t=n.ADBase,__extends(i,t),i.prototype.__I_SetRewardedVideoAvailable=function(e){this._i_RewardedVideoAvailable=e,this.RewardedVideoBV.v=e},i.prototype.IsSupport=function(){return!0},i.prototype.OnInit=function(){},i.prototype.ShowBannerImpl=function(e){console.info("DefaultAD >> "+(e?"显示横幅广告":"隐藏横幅广告"))},i.prototype.IsInterstitialAvailableImpl=function(){return!1},i.prototype.LoadInterstitialImpl=function(){},i.prototype.ShowInterstitialImpl=function(e){e(n.EInterstitial.NOT_AVAILABLE)},i.prototype.IsRewardedVideoAvailableImpl=function(){return this._i_RewardedVideoAvailable},i.prototype.ShowRewardedVideoImpl=function(e){var t=this;this._i_RewardedVideoAvailable?(e(n.EInternalRewardedVideo.SHOW,!1),e(n.EInternalRewardedVideo.REWARDED,!0),e(n.EInternalRewardedVideo.HIDE,!0),this.__I_SetRewardedVideoAvailable(!1),this.scheduleOnce(function(){t.__I_SetRewardedVideoAvailable(!0)},2)):e(n.EInternalRewardedVideo.NOT_AVAILABLE,!1)},i.prototype.InitByScriptImpl=function(){var e=this;this.scheduleOnce(function(){e.__I_SetRewardedVideoAvailable(!0)},2)},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._i_RewardedVideoAvailable=!1,e}n.DefaultAD=e}(numas=numas||{}),function(e){var t,n=(t=e.PlatformBase,__extends(i,t),i.prototype.GetUserClass=function(){return e.DefaultUser},i.prototype.GetADClass=function(){return e.DefaultAD},i.prototype.GetVibrateClass=function(){return e.DefaultVibrate},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.DefaultPlatform=n}(numas=numas||{}),function(e){var t,n=(t=e.UserBase,__extends(i,t),i.prototype.IsAuthedUserInfo=function(){return!0},i.prototype.AuthUserInfo=function(e,t,n){t()},i.prototype.LoginPlatform=function(e,t){e({success:!0,openid:"dev_openid"})},i.prototype.ReportScore=function(e,t){},i.prototype.GetGameCenterCfg=function(){return this.sdkCfg.iOS.GameCenter},i.prototype.OnLoginServerSuccess=function(){},i.prototype.OnLoginServerFailed=function(){},i.prototype.FiveStar=function(){},i.prototype.IsSupportLeaderboard=function(){return!1},i.prototype.ShowDefaultLeaderboard=function(){},i.prototype.IsSupportRateUsByOpenUrl=function(){return!1},i.prototype.RateUsByOpenUrl=function(){},i.prototype.IsSupportContactUs=function(){return!1},i.prototype.ContactUs=function(){},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.DefaultUser=n}(numas=numas||{}),function(e){var t,n=(t=e.VibrateBase,__extends(i,t),i.prototype.DefaultImpl=function(){},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.DefaultVibrate=n}(numas=numas||{}),function(t){var e,n=(e=t.ADBase,__extends(i,e),i.prototype.IsSupport=function(){return!1},i.prototype.InitByScriptImpl=function(){console.warn("// WeChatAD >> InitByScriptImpl")},i.prototype.OnInit=function(e){},i.prototype.ShowBannerImpl=function(e){console.warn("// WeChatAD >> ShowBannerImpl")},i.prototype.IsInterstitialAvailableImpl=function(){return console.warn("// WeChatAD >> IsInterstitialAvailableImpl"),!1},i.prototype.LoadInterstitialImpl=function(){console.warn("// WeChatAD >> LoadInterstitialImpl")},i.prototype.ShowInterstitialImpl=function(e){console.warn("// WeChatAD >> ShowInterstitialImpl"),e(t.EInterstitial.NOT_AVAILABLE)},i.prototype.IsRewardedVideoAvailableImpl=function(){return console.warn("// WeChatAD >> IsRewardedVideoAvailableImpl"),!1},i.prototype.ShowRewardedVideoImpl=function(e){console.warn("// WeChatAD >> ShowRewardedVideoImpl"),e(t.EInternalRewardedVideo.NOT_AVAILABLE,!1)},i);function i(){return null!==e&&e.apply(this,arguments)||this}t.WeChatAD=n}(numas=numas||{}),function(a){let i;(e=i=a.WeChatAuthScope||(a.WeChatAuthScope={}))[e.userInfo=0]="userInfo",e[e.writePhotosAlbum=1]="writePhotosAlbum";var e=(t.IsAuthed=function(t){var n=this;let i=!1;return this.GetSetting(function(e){i=n.__IsAuth(e.authSetting,t)},function(){i=!1}),i},t.AuthUserInfo=function(e,t,n){this.IsAuthed(i.userInfo)?a.Util.safeCall(t):this.__AuthUserInfo(e,t,n)},t.GetSetting=function(t,e){window.wx.getSetting({success:function(e){t(e)},fail:function(){console.error("WeChatUtil >> Auth::getSetting failed."),a.Util.safeCall(e)}})},t.__IsAuth=function(e,t){if(!e)return!1;let n=null;switch(t){case i.userInfo:n="scope.userInfo";break;case i.writePhotosAlbum:n="scope.writePhotosAlbum";break;default:throw new Error("WeChatUtil >> __Typ2AuthSettingKey: 未处理的授权类型 typ = "+t)}return e[n]},t.__AuthUserInfo=function(e,t,n){e=e&&this.convertToWxPos(e);let i=0,o=0,r=0,s=0;e&&(i=e.left,o=e.top,r=e.width,s=e.height);let u=window.wx.createUserInfoButton({type:"image",image:"",style:{left:i,top:o,width:r,height:s,lineHeight:40,borderColor:"#00000000",borderWidth:0,backgroundColor:"#00000000",color:"#ffffffff",textAlign:"center",fontSize:16,borderRadius:4}});u.onTap(function(e){cc.isValid(u)&&u.destroy(),e.userInfo?a.Util.safeCall(t):a.Util.safeCall(n)})},t.convertToWxPos=function(e){if(!e)return null;var t=e.convertToWorldSpaceAR(cc.v2(-e.width*e.anchorX,-e.height*e.anchorY)),n=e.convertToWorldSpaceAR(cc.v2(e.width*(1-e.anchorX),e.height*(1-e.anchorY))),i=cc.view.getFrameSize(),e=cc.view.getVisibleSize();return{left:t.x/e.width*i.width,top:i.height-n.y/e.height*i.height,width:(n.x-t.x)/e.width*i.width,height:(n.y-t.y)/e.height*i.height}},t);function t(){}a.WeChatAuthUtil=e}(numas=numas||{}),function(e){var t,n=(t=e.PlatformBase,__extends(i,t),i.prototype.GetUserClass=function(){return e.WeChatUser},i.prototype.GetADClass=function(){return e.WeChatAD},i.prototype.GetVibrateClass=function(){return e.WeChatVibrate},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.WeChatPlatform=n}(numas=numas||{}),function(i){var e,t=(e=i.UserBase,__extends(n,e),n.prototype.IsAuthedUserInfo=function(){return!0},n.prototype.AuthUserInfo=function(e,t,n){i.WeChatAuthUtil.AuthUserInfo(e,t,n)},n.prototype.LoginPlatform=function(e,t){e({success:!0,openid:i.Cfg.DefaultUserKey})},n.prototype.__GetUserInfo=function(){window.wx.getUserInfo({withCredentials:!1,success:function(e){e=e.userInfo;e&&(console.warn("获得的用户信息 >> 成功"),console.warn(e))},fail:function(e){console.warn("获得的用户信息 >> 失败")}})},n.prototype.OnLoginServerSuccess=function(){},n.prototype.OnLoginServerFailed=function(){},n.prototype.GetGameCenterCfg=function(){return this.sdkCfg.wx.GameCenter},n.prototype.ReportScore=function(e,t){},n.prototype.FiveStar=function(){},n.prototype.IsSupportLeaderboard=function(){return!1},n.prototype.ShowDefaultLeaderboard=function(){},n.prototype.IsSupportRateUsByOpenUrl=function(){return!1},n.prototype.RateUsByOpenUrl=function(){},n.prototype.IsSupportContactUs=function(){return!1},n.prototype.ContactUs=function(){},n);function n(){return null!==e&&e.apply(this,arguments)||this}i.WeChatUser=t}(numas=numas||{}),function(e){var t,n=(t=e.VibrateBase,__extends(i,t),i.prototype.DefaultImpl=function(){this.vibrateShort("light")},i.prototype.vibrateShort=function(e){window.wx.vibrateShort({type:e})},i.prototype.vibrateLong=function(){window.wx.vibrateLong()},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.WeChatVibrate=n}(numas=numas||{}),function(n){let i;(e=i=i||{}).AUTHORIZED="AUTHORIZED",e.DENIED="DENIED",e.RESTRICTED="RESTRICTED",e.NOT_DETERMINED="NOT_DETERMINED";var e=(Object.defineProperty(t,"ins",{get:function(){return null===this._ins&&(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.Init=function(e){var t=this;n.iOSMsgBridge.ins.on("NMEventATT",function(e){return t.iOSCallbackHandler(e)},this)},t.prototype.iOSCallbackHandler=function(e){"REQUEST_TRACKING_AUTHORIZATION"===e.event?this.HandleRequestTrackingAuthorizationResult(e):console.warn("Unhandled iOS Event >> "+e.event)},t.prototype.HandleRequestTrackingAuthorizationResult=function(t){if(null!==this.m_RequestIDFACallback){let e=this.m_RequestIDFACallback;this.m_RequestIDFACallback=null,e(t.status==i.AUTHORIZED)}},t.prototype.RequestTrackingAuthorization=function(e,t){this.m_RequestIDFACallback=n.Util.onceCall(e,1),jsb.reflection.callStaticMethod("NMProxyATT","RequestTrackingAuthorization:",t)},t._ins=null,t);function t(){this.m_RequestIDFACallback=null}n.iOSATT=e}(numas=numas||{}),function(n){var e=(Object.defineProperty(t,"ins",{get:function(){return null===this._ins&&(this._ins=new t),this._ins},enumerable:!1,configurable:!0}),t.prototype.Init=function(e){var t=this;n.iOSMsgBridge.ins.on("NMEventUser",function(e){return t.iOSCallbackHandler(e)},this)},t.prototype.InvokeLoginCallback=function(t,n){if(this.m_LoginCallback){let e=this.m_LoginCallback;this.m_LoginCallback=null,e(t,n)}},t.prototype.Login=function(n){var i=this;this.m_LoginCallback=function(e,t){n(e?{success:!0,openid:i.GetUserId()}:{success:!1,error:t})},this.LoginGameCenter()},t.prototype.iOSCallbackHandler=function(e){switch(e.event){case"LOGIN":this.HandleLogin(e);break;case"REQUEST_LOCAL_PLAYER_SCORE":this.HandleRequestLocalPlayerScore(e);break;default:console.warn("Unhandled iOS Event >> "+e.event)}},t.prototype.HandleLogin=function(e){this.InvokeLoginCallback(e.success,e.reason)},t.prototype.HandleRequestLocalPlayerScore=function(e){var t=this.m_sync_uid;null!==this.m_SyncHandler&&(this.m_SyncHandler(e.identifier,e.score),this.SetIsSynced(t,!0))},t.prototype.SyncGameCenter=function(e,t,n){var i=this;this.GetIsSynced(e)||(this.m_SyncHandler=n,console.info("iOSGameCenter >> 开始同步服务器数据 uid: "+e),this.m_sync_uid=e,t.Ranks.forEach(function(e){i.RequestLocalPlayScore(e.v)}))},t.prototype.GetIsSynced=function(e){return n.LSMgr.ins.getBoolWithDefault(e+"_ls_gamecenter_sync",!1)},t.prototype.SetIsSynced=function(e,t){n.LSMgr.ins.setBool(e+"_ls_gamecenter_sync",t,!1)},t.prototype.LoginGameCenter=function(){jsb.reflection.callStaticMethod("NMProxyUser","Login")},t.prototype.GetUserId=function(){return jsb.reflection.callStaticMethod("NMProxyUser","GetUserId")},t.prototype.IsAuthenticated=function(){return jsb.reflection.callStaticMethod("NMProxyUser","IsAuthenticated")},t.prototype.ReportScore=function(e,t){jsb.reflection.callStaticMethod("NMProxyUser","ReportScore:withScore:",e,t)},t.prototype.ReportAchievement=function(e,t){jsb.reflection.callStaticMethod("NMProxyUser","ReportAchievement:percentComplete:",e,t)},t.prototype.FiveStar=function(){jsb.reflection.callStaticMethod("NMProxyUser","FiveStar")},t.prototype.ShowDefaultLeaderboard=function(){jsb.reflection.callStaticMethod("NMProxyUser","ShowDefaultLeaderboard")},t.prototype.ShowLeaderboards=function(e,t){jsb.reflection.callStaticMethod("NMProxyUser","ShowLeaderboards:timeScope:",e,t)},t.prototype.ShowAchievement=function(){jsb.reflection.callStaticMethod("NMProxyUser","ShowAchievement")},t.prototype.RateUsByOpenUrl=function(e){jsb.reflection.callStaticMethod("NMProxyUser","RateUsByOpenUrl:",e)},t.prototype.RateUsWithinApp=function(e){jsb.reflection.callStaticMethod("NMProxyUser","RateUsWithinApp:",e)},t.prototype.RequestLocalPlayScore=function(e){this.IsAuthenticated()&&jsb.reflection.callStaticMethod("NMProxyUser","RequestLocalPlayScore:",e)},t._ins=null,t);function t(){this.m_LoginCallback=null,this.m_sync_uid=null,this.m_SyncHandler=null}n.iOSGameCenter=e}(numas=numas||{}),function(n){var t,e=(t=n.ADBase,__extends(i,t),i.prototype.IsSupport=function(){return!0},i.prototype.InitByScriptImpl=function(){var t=this;this._init_by_script||(this._init_by_script=!0,n.iOSMsgBridge.ins.on("NMEventAD",function(e){return t.iOSCallbackHandler(e)},this),jsb.reflection.callStaticMethod("NMProxyAD","initByScript:",n.CfgUtil.k2v(this.sdkCfg.iOS.kvs,"IronSourceAppKey")))},i.prototype.OnInit=function(){},i.prototype.ShowBannerImpl=function(e){e?jsb.reflection.callStaticMethod("NMProxyAD","ShowBanner"):jsb.reflection.callStaticMethod("NMProxyAD","HideBanner")},i.prototype.DestroyBanner=function(){jsb.reflection.callStaticMethod("NMProxyAD","DestroyBanner")},i.prototype.IsInterstitialAvailableImpl=function(){return jsb.reflection.callStaticMethod("NMProxyAD","IsInterstitialAvailable")},i.prototype.LoadInterstitialImpl=function(){jsb.reflection.callStaticMethod("NMProxyAD","LoadInterstitial")},i.prototype.ShowInterstitialImpl=function(e){this.m_ShowInterstitialCallback=e,jsb.reflection.callStaticMethod("NMProxyAD","ShowInterstitial")},i.prototype.IsRewardedVideoAvailableImpl=function(){return jsb.reflection.callStaticMethod("NMProxyAD","IsRewardedVideoAvailable")},i.prototype.ShowRewardedVideoImpl=function(e){this.m_ShowRewardedVideoCallback=e,n.iOSATT.ins.RequestTrackingAuthorization(function(e){n.UIMgr.ins.blockSeconds(.05,function(){jsb.reflection.callStaticMethod("NMProxyAD","ShowRewardedVideo")})},!0)},i.prototype.onDestroy=function(){n.iOSMsgBridge.ins.targetOff(this),t.prototype.onDestroy.call(this)},i.prototype.ShowInterstitialCallback=function(e){this.m_ShowInterstitialCallback&&this.m_ShowInterstitialCallback(e)},i.prototype.ShowRewardedVideoCallback=function(e,t){this.m_ShowRewardedVideoCallback&&this.m_ShowRewardedVideoCallback(e,t)},i.prototype.iOSCallbackHandler=function(e){switch(e.type){case"RewardedVideo":this.HandleRewardedVideo(e);break;case"Interstitial":this.HandleInterstitial(e);break;case"Banner":this.HandleBanner(e)}},i.prototype.HandleBanner=function(e){e.event},i.prototype.HandleInterstitial=function(e){switch(e.event){case"LOADED":case"LOAD_ERROR":break;case"SHOW":this.ShowInterstitialCallback(n.EInterstitial.SHOW);break;case"SHOW_ERROR":this.ShowInterstitialCallback(n.EInterstitial.SHOW_ERROR);break;case"CLICK":this.ShowInterstitialCallback(n.EInterstitial.CLICK);break;case"CLOSE":this.ShowInterstitialCallback(n.EInterstitial.HIDE);break;default:this.ShowInterstitialCallback(n.EInterstitial.NOT_AVAILABLE)}},i.prototype.HandleRewardedVideo=function(e){switch(e.event){case"AVAILABLE_STATUS_CHANGED":this.RewardedVideoBV.v=e.available;break;case"SHOW":this.ShowRewardedVideoCallback(n.EInternalRewardedVideo.SHOW,e.rewarded);break;case"SHOW_ERROR":this.ShowRewardedVideoCallback(n.EInternalRewardedVideo.SHOW_ERROR,e.rewarded);break;case"REWARDED":this.ShowRewardedVideoCallback(n.EInternalRewardedVideo.REWARDED,e.rewarded);break;case"CLOSE":this.ShowRewardedVideoCallback(n.EInternalRewardedVideo.HIDE,e.rewarded);break;case"CLICK":break;default:this.ShowRewardedVideoCallback(n.EInternalRewardedVideo.NOT_AVAILABLE,e.rewarded)}},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e._init_by_script=!1,e.m_ShowInterstitialCallback=null,e.m_ShowRewardedVideoCallback=null,e}n.iOSIronSourceAD=e}(numas=numas||{}),function(e){var t,n=(t=cc.EventTarget,__extends(i,t),Object.defineProperty(i,"ins",{get:function(){var n;return this._ins||(this._ins=new i,n=this,CC_DEBUG&&console.info("iOSMsgBridge >> 注册桥接监听器"),window._G_EventHandler=function(e,t){n._ins.EmitiOSEvent(e,t?JSON.parse(t):null)}),this._ins},enumerable:!1,configurable:!0}),i.prototype.EmitiOSEvent=function(e,t){this.emit(e,t)},i._ins=null,i);function i(){return null!==t&&t.apply(this,arguments)||this}e.iOSMsgBridge=n}(numas=numas||{}),function(t){var n,e=(n=t.PlatformBase,__extends(i,n),i.prototype.GetUserClass=function(){return t.iOSUser},i.prototype.GetADClass=function(){return t.iOSIronSourceAD},i.prototype.GetVibrateClass=function(){return t.iOSVibrate},i.prototype.Init=function(e){return n.prototype.Init.call(this,e),t.iOSATT.ins.Init(e),this},i);function i(){return null!==n&&n.apply(this,arguments)||this}t.iOSPlatform=e}(numas=numas||{}),function(i){var t,e=(t=i.UserBase,__extends(n,t),n.prototype.OnInit=function(e){t.prototype.OnInit.call(this,e),i.iOSGameCenter.ins.Init(e)},n.prototype.IsAuthedUserInfo=function(){return!0},n.prototype.AuthUserInfo=function(e,t,n){t()},n.prototype.LoginPlatform=function(e,t){i.iOSGameCenter.ins.Login(e)},n.prototype.OnLoginServerSuccess=function(){var n=this;i.iOSGameCenter.ins.SyncGameCenter(this.uid,this.sdkCfg.iOS.GameCenter,function(e,t){e=n.RealKey2DevKey(e);n.SetGameCenterVal(e,n.GetGameCenterVal(e)+t)})},n.prototype.OnLoginServerFailed=function(){},n.prototype.GetGameCenterCfg=function(){return this.sdkCfg.iOS.GameCenter},n.prototype.ReportScore=function(e,t){i.iOSGameCenter.ins.ReportScore(e,t)},n.prototype.FiveStar=function(){i.iOSGameCenter.ins.FiveStar()},n.prototype.IsSupportLeaderboard=function(){return!0},n.prototype.ShowDefaultLeaderboard=function(){this.UploadGameTime(),i.iOSGameCenter.ins.ShowDefaultLeaderboard()},n.prototype.IsSupportRateUsByOpenUrl=function(){return!0},n.prototype.RateUsByOpenUrl=function(){i.iOSGameCenter.ins.RateUsByOpenUrl(this.sdkCfg.iOS.AppId)},n.prototype.IsSupportContactUs=function(){return!0},n.prototype.ContactUs=function(){this.openSystemMailApp("huaxing_zheng@qq.com","")},n.prototype.openSystemMailApp=function(e,t,n,i,o){void 0===n&&(n=""),void 0===i&&(i=""),void 0===o&&(o="");o="mailto:"+e+"?subject="+t+"&cc="+n+"&bcc="+i+"&body="+o;cc.sys.openURL(o)},n);function n(){return null!==t&&t.apply(this,arguments)||this}i.iOSUser=e}(numas=numas||{}),function(e){var t,n=(t=e.VibrateBase,__extends(i,t),i.prototype.DefaultImpl=function(){this.vibrateNormal()},i.prototype.vibrateNormal=function(){this.__bridgeVibrate("NORMAL")},i.prototype.vibratePeek=function(){this.__bridgeVibrate("PEEK")},i.prototype.vibratePop=function(){this.__bridgeVibrate("POP")},i.prototype.vibrateContinue=function(){this.__bridgeVibrate("CONTINUE")},i.prototype.__bridgeVibrate=function(e){jsb.reflection.callStaticMethod("NMVibrate","vibrate:",e)},i.prototype.tap_notification=function(e){void 0===e&&(e=2),jsb.reflection.callStaticMethod("NMVibrate","tap_notification:",e)},i.prototype.tap_selection=function(){jsb.reflection.callStaticMethod("NMVibrate","tap_selection")},i.prototype.tap_impact=function(e){void 0===e&&(e=4),jsb.reflection.callStaticMethod("NMVibrate","tap_impact:",e)},i.prototype.isSupportTapEngine=function(){return jsb.reflection.callStaticMethod("NMVibrate","isSupportTapEngine")},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.iOSVibrate=n}(numas=numas||{}),function(e){var n,t=(Object.defineProperty(i.prototype,"seed",{get:function(){return this.kOriginRandomSeed},enumerable:!1,configurable:!0}),i.prototype.random=function(){var e=(this.kRandomSeed*this.kMultiplier+this.kConstant)%this.kModer,t=e/this.kModer;return this.kRandomSeed=e,this.bIsDebug&&(++this.kRandomCount,console.log(">>Rand{"+this.kOriginRandomSeed+"}: Count{"+this.kRandomCount+"} Seed{"+this.kRandomSeed+"} Ret:{"+t+"}")),t},i.prototype.range=function(e,t){return console.assert(e<t),Math.floor(this.random()*(t-e)+e)},i);function i(e,t,n,i,o){void 0===o&&(o=!1),this.kMultiplier=3125,this.kModer=34359738337,this.kConstant=0,this.kOriginRandomSeed=null,this.kRandomSeed=null,this.bIsDebug=!1,this.kRandomCount=0,this.kMultiplier=e,this.kModer=t,this.kConstant=n,i&&0!==i||(i=1),this.kOriginRandomSeed=i,this.kRandomSeed=i,this.bIsDebug=o}let o=(n=t,__extends(r,n),Object.defineProperty(r,"ins",{get:function(){return this._ins||(this._ins=new r(e.date.getMilliTimeStamp(),!1)),this._ins},enumerable:!1,configurable:!0}),r._ins=null,r);function r(e,t){return void 0===t&&(t=!1),n.call(this,3125,34359738337,0,e,t)||this}function s(){}e.MCGRand=o,s.IntBetween=function(e,t){return o.ins.range(e,t)},t=s,e.rand=t}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){var t=this;this.BindBV(e.UIMgr.ins.block,function(e){return t.OnActiveChanged(e)},!0)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.BaseBlockInputUIPanel=n}(numas=numas||{}),function(n){var e,t=(e=n.UIPanel,__extends(i,e),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){var t=this;this.BindBV(n.ResListLoaderInfo.ins.loaderCnt,function(e){t.OnActiveChanged(0<e),t.__OnLoading(n.ResListLoaderInfo.ins.finishTaskCnt.v,n.ResListLoaderInfo.ins.totalTaskCnt.v)},!0),this.BindBV(n.ResListLoaderInfo.ins.finishTaskCnt,function(e){t.__OnLoading(e,n.ResListLoaderInfo.ins.totalTaskCnt.v)},!0),this.BindBV(n.ResListLoaderInfo.ins.totalTaskCnt,function(e){t.__OnLoading(n.ResListLoaderInfo.ins.finishTaskCnt.v,e)},!0)},i.prototype.__OnLoading=function(e,t){0<n.ResListLoaderInfo.ins.loaderCnt.v&&this.OnLoading(e,t)},i);function i(){return null!==e&&e.apply(this,arguments)||this}n.BaseLoadingUIPanel=t}(numas=numas||{}),function(n){var e,t=(e=n.UIPanel,__extends(i,e),i.prototype.OnCreate=function(){this.SetUserData("K_INIT_POS",this.ActionNode.position)},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(e){var t=this;this.MsgLabel.string=n.LangUtil.Get.apply(n.LangUtil,this.args.msg),cc.tween(this.ActionNode).to(.2,{opacity:255,position:cc.Vec3.ZERO}).delay(3).to(.2,{opacity:0,position:this.GetUserData("K_INIT_POS")}).call(function(){t.Close()}).start()},i);function i(){return null!==e&&e.apply(this,arguments)||this}n.BaseMsgUIPanel=t}(numas=numas||{}),function(e){var t,n=(t=e.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(){var t=this;this.BindBV(e.UIMgr.ins.waiting,function(e){return t.OnActiveChanged(e)},!0)},i);function i(){return null!==t&&t.apply(this,arguments)||this}e.BaseWaitingUIPanel=n}(numas=numas||{}),function(s){s.dirty=function(o){return function(e,t,n){let i=n.value;return n.value=function(){let t=[];for(let e=0;e<arguments.length;e++)t[e]=arguments[e];i.apply(this,t)&&this.markDirty(o)},n}};var t,e=(t=s.BaseComp,__extends(n,t),Object.defineProperty(n.prototype,"DataCacheName",{get:function(){return this._i_Name},set:function(e){this._i_Name=e},enumerable:!1,configurable:!0}),n.prototype.__i_Tick=function(e){this._i_Dirty&&(this._i_DirtySeconds+=e,this._i_DirtySeconds>=this._i_MaxSecondsToSave&&(this.__i_StopTick(),this.OnDirty()))},n.prototype.__i_StopTick=function(){this.GetUserData("_i_TICK")&&(this._i_MaxSecondsToSave=86400,this._i_Dirty=!1,this._i_DirtySeconds=0,this.unschedule(this.GetUserData("_i_TICK")))},n.prototype.__i_OnPreRegister=function(){},n.prototype.__i_OnRegisterTo=function(){this.__i_OnPreRegister(),this.OnRegister()},n.prototype.__i_OnUnRegister=function(){this.__i_StopTick(),this._i_Dirty&&this.OnDirty(),this.OnUnRegister()},n.prototype.markDirty=function(e){this._i_Dirty?e<this._i_MaxSecondsToSave&&(this._i_MaxSecondsToSave=e):(this._i_Dirty=!0,e<this._i_MaxSecondsToSave&&(this._i_MaxSecondsToSave=e),this.HasUserData("_i_TICK")||this.SetUserData("_i_TICK",this.__i_Tick.bind(this,1)),this.schedule(this.GetUserData("_i_TICK"),1,cc.macro.REPEAT_FOREVER))},n);function n(){let e=null!==t&&t.apply(this,arguments)||this;return e._i_Name=null,e._i_Dirty=!1,e._i_DirtySeconds=0,e._i_MaxSecondsToSave=86400,e}s.DataCache=e;var i,e=(i=e,__extends(o,i),Object.defineProperty(o.prototype,"data",{get:function(){return this._lsData},enumerable:!1,configurable:!0}),o.prototype.Save=function(){s.UserLSMgr.ins.setObject(this.LSKey,this._lsData,!0)},o.prototype.OnDirty=function(){this.Save()},o.prototype.__i_OnPreRegister=function(){s.UserLSMgr.ins.hasKey(this.LSKey)?this._lsData=s.UserLSMgr.ins.getObject(this.LSKey):this._lsData=this.DefaultLSData},o);function o(){let e=null!==i&&i.apply(this,arguments)||this;return e._lsData=null,e}function r(){}s.LSDataCache=e,r.GetDataCache=function(e){return s.ResMgr.ins.GetDataCache(e)},r.emitGlobal=function(e,t,n,i,o,r){s.EventCenter.ins.emit(e,t,n,i,o,r)},e=r,s.Logic=e;var u,e=(u=cc.EventTarget,__extends(a,u),a.prototype.Return=function(){this.Reset(),this.UnbindAllBV(),this.Destroy_AutoRelease()},a.prototype.ReturnBy=function(e){return e.AutoReturn(this)},a.prototype.AutoReturn=function(e){return this._I_AutoReleaseItemQueue.Enqueue(s.AutoReleaseItem.Borrow(e,s.EItemType.IReference)),e},Object.defineProperty(a.prototype,"_I_AutoReleaseItemQueue",{get:function(){return null===this._i_AutoQueue&&(this._i_AutoQueue=s.AnyQueue.Borrow()),this._i_AutoQueue},enumerable:!1,configurable:!0}),a.prototype.Destroy_AutoRelease=function(){null!=this._i_AutoQueue&&(s.ResMgr.ins.DestroyAutoReleaseItems(this._i_AutoQueue),this._i_AutoQueue.Return(),this._i_AutoQueue=null)},a.prototype.BindBV=function(e,t,n){e.Bind(t,n,this),this._m_BVList_.push(e)},a.prototype.UnbindAllBV=function(){for(;0<this._m_BVList_.length;)this._m_BVList_.pop().TargetUnbind(this)},a);function a(){let e=null!==u&&u.apply(this,arguments)||this;return e._i_AutoQueue=null,e._m_BVList_=[],e}s.Entity=e}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n.prototype.GetBundleName=function(e){return this._m.get(e)},n.prototype.SetBundleName=function(e,t){this._m.set(e,t)},n.prototype.HasBundleName=function(e){return this._m.has(e)},n._ins=null,n);function n(){this._m=new Map}e.ResKey2BundleName=t}(numas=numas||{}),function(e){var t=(Object.defineProperty(n,"ins",{get:function(){return null===this._ins&&(this._ins=new n),this._ins},enumerable:!1,configurable:!0}),n.prototype.GetResType=function(e){return this._m.get(e)},n.prototype.SetResType=function(e,t){this._m.set(e,t)},n.prototype.HasResType=function(e){return this._m.has(e)},n._ins=null,n);function n(){this._m=new Map}e.ResKey2ResType=t}(numas=numas||{}),function(u){let a;function o(e,t,n){if(CC_DEBUG){if(u.ResKey2BundleName.ins.HasBundleName(e)&&u.ResKey2BundleName.ins.GetBundleName(e)!==t)return void console.error("registerRes >> 资源关键字 "+e+" 的包名前后不一致："+u.ResKey2BundleName.ins.GetBundleName(e)+" -> "+t);if(u.ResKey2ResType.ins.HasResType(e)&&u.ResKey2ResType.ins.GetResType(e)!==n)return void console.error("registerRes >> 资源关键字 "+e+" 的资源类型前后不一致："+u.ResKey2ResType.ins.GetResType(e)+" -> "+n)}u.ResKey2BundleName.ins.SetBundleName(e,t),u.ResKey2ResType.ins.SetResType(e,n)}(e=a=u.EResType||(u.EResType={}))[e.Asset=0]="Asset",e[e.Audio=1]="Audio",e[e.Json=2]="Json",e[e.Prefab=3]="Prefab",e[e.Stage=4]="Stage",e[e.SpriteFrame=5]="SpriteFrame",e[e.Anim=6]="Anim",e[e.Spine=7]="Spine",e[e.LangJson=8]="LangJson",e[e.AutoAtlas=9]="AutoAtlas",u.registerRes=o,u.registerResDict=function(e,t,n){for(var i in e)o(e[i],t,n)},u.resDict2ResKeyList=function(e){let t=[];for(var n in e)t.push(e[n]);return t},u.registerPrefabCfg=function(e,t){for(var n in e.panel)u.registerUIPanel(e.panel[n].key,e.panel[n].z,t);for(var i in e.comp)o(e.comp[i].key,t,a.Prefab)},u.prefabCfg2ResKeyList=function(e){let t=[];for(var n in e)t.push(e[n].key);return t},u.registerLangJsonCfg=function(e,t){for(var n in e)o(e[n],t,a.LangJson)};let t;(e=t=u.EItemType||(u.EItemType={}))[e.ResKey=0]="ResKey",e[e.DataCache=1]="DataCache",e[e.IReference=2]="IReference";var e=(i.Borrow=function(e,t){let n=u.ReferencePool.Borrow(i);return n.resKey=e,n.resTyp=t,n},i.prototype.Reset=function(){this.resKey=null,this.resTyp=null},i.prototype.Return=function(){u.ReferencePool.Return(i,this)},i);function i(){this.resKey=null,this.resTyp=null}u.AutoReleaseItem=e;let r=(s.Borrow=function(e,t){let n=u.ReferencePool.Borrow(s);return n.resKey=e,n.cb=t,n},s.prototype.Reset=function(){this.resKey=null,this.cb=null},s.prototype.Return=function(){u.ReferencePool.Return(s,this)},s);function s(){this.resKey=null,this.cb=null}var l,e=(l=cc.Component,__extends(n,l),n.prototype.onLoad=function(){CC_DEBUG&&console.info(">> ResMgr::onLoad"),null===n.ins?n.ins=this:this.destroy()},n.prototype.AddResRef=function(e){this._i_AssetCache.AddRef(e)},n.prototype.DecResRef=function(e){this._i_AssetCache.DecRef(e)},n.prototype.GetRes=function(e){return this._i_AssetCache.GetRes(e)},n.prototype.HasRes=function(e){return this._i_AssetCache.HasRes(e)},n.prototype.SetRes=function(e,t){this._i_AssetCache.SetRes(e,t),u.ResKey2ResType.ins.GetResType(e)===a.LangJson&&u.LangUtil.AddLangCfg(t.json)},n.prototype.HasRegister=function(e){return u.ResKey2BundleName.ins.HasBundleName(e)&&u.ResKey2ResType.ins.HasResType(e)},n.prototype.GetOrLoadBundle=function(e,t){return c.GetOrLoadBundle(e,t)},n.prototype.__Load=function(o,r){var e,s=this;this._i_AssetCache.AddRef(o),this._i_AssetCache.HasRes(o)?(e=this._i_AssetCache.GetRes(o),r(e,o),this._i_AssetCache.DecRef(o)):(this._i_AssetCache.AddLoadingRef(o),e=u.ResKey2BundleName.ins.GetBundleName(o),c.GetOrLoadBundle(e,function(e){var t,n,i=u.ResKey2ResType.ins.GetResType(o),n=(t=i,n=o,"Res/"+a[t]+"/"+n),i=function(e){switch(e){case a.Asset:return cc.Asset;case a.Audio:return cc.AudioClip;case a.Json:return cc.JsonAsset;case a.Prefab:case a.Stage:return cc.Prefab;case a.SpriteFrame:return cc.SpriteFrame;case a.Anim:return cc.AnimationClip;case a.Spine:return sp.SkeletonData;case a.LangJson:return cc.JsonAsset;case a.AutoAtlas:return cc.SpriteFrame;default:throw new Error("未知的资源类型: "+e)}}(i);c.Load(e,n,i,function(e){s.SetRes(o,e),s._i_AssetCache.DecLoadingRef(o),r(e,o),s._i_AssetCache.DecRef(o)})}))},n.prototype.Load=function(e,t){void 0===u.ResKey2BundleName.ins.GetBundleName(e)&&console.error("找不到 BundleName >> "+e),this.__Load(e,t)},n.prototype.LoadWithEvent=function(n,e){var i=this;this.Load(e,function(e,t){i.node.emit(n,e,t),i.node.off(n)})},n.prototype.LoadWithEventByGroup=function(n,e,t){var i=this;this.LoadByGroup(e,function(e,t){i.node.emit(n,e,t),i.node.off(n)},t)},n.prototype.LoadByGroup=function(t,n,i){var o=this;if(void 0===u.ResKey2BundleName.ins.GetBundleName(t)&&console.error("找不到 BundleName >> "+t),this.HasLoadingGroup(i)){this.AddLoadingGroup(i);let e=this.GetLoadingGroup(i);e.Enqueue(r.Borrow(t,function(e,t){n(e,t),o.DecLoadingGroup(i)}))}else this.AddLoadingGroup(i),this.__Load(t,function(e,t){n(e,t),o.__i_TryToLoadNextGroupItem(i),o.DecLoadingGroup(i)})},n.prototype.__i_TryToLoadNextGroupItem=function(n){if(this.HasLoadingGroup(n)){let t=this.GetLoadingGroup(n);if(0!=t.Count){let e=t.Dequeue();var i=e.resKey,o=e.cb;return e.Return(),this.LoadByGroup(i,o,n)}}},n.prototype.AddLoadingGroup=function(e){this._i_LoadingGroupCache.HasRes(e)?this._i_LoadingGroupCache.AddRef(e):(this._i_LoadingGroupCache.AddLoadingRef(e),this._i_LoadingGroupCache.AddRef(e),this._i_LoadingGroupCache.SetRes(e,u.AnyQueue.Borrow()),this._i_LoadingGroupCache.DecLoadingRef(e))},n.prototype.HasLoadingGroup=function(e){return this._i_LoadingGroupCache.HasRes(e)},n.prototype.GetLoadingGroup=function(e){return this._i_LoadingGroupCache.GetRes(e)},n.prototype.DecLoadingGroup=function(e){this._i_LoadingGroupCache.DecRef(e)},n.prototype.GetDataCache=function(e){return this._i_DataCacheCache.GetRes(e)},n.prototype.AddDataCache=function(t,n){if(this._i_DataCacheCache.HasRes(t))this._i_DataCacheCache.AddRef(t);else{this._i_DataCacheCache.AddLoadingRef(t),this._i_DataCacheCache.AddRef(t);let e=this.node.addComponent(n);e.DataCacheName=t,this._i_DataCacheCache.SetRes(e.DataCacheName,e),this._i_DataCacheCache.DecLoadingRef(t),e.__i_OnRegisterTo()}},n.prototype.hasDataCache=function(e){return this._i_DataCacheCache.HasRes(e)},n.prototype.DecDataCache=function(e){this._i_DataCacheCache.DecRef(e)},n.prototype.DestroyAutoReleaseItems=function(e){var t=this;e.RemoveAll(function(e){return t._i_NextFrameToReleaseResQueue.Enqueue(e)}),this.GC()},n.prototype.GC=function(){null===this._i_TickScheduler&&(0<this._i_NextFrameToReleaseResQueue.Count||0<this._i_Next2FrameToReleaseResQueue.Count)&&(this._i_TickScheduler=this.__i_Tick.bind(this),this.schedule(this._i_TickScheduler,0,cc.macro.REPEAT_FOREVER,0))},n.prototype.__i_StopTickSchedule=function(){null!==this._i_TickScheduler&&(this.unschedule(this._i_TickScheduler),this._i_TickScheduler=null)},n.prototype.__i_Tick=function(){if(!this.m_bLoadingGame)if(0<this._i_Next2FrameToReleaseResQueue.Count){let e=this._i_Next2FrameToReleaseResQueue.Dequeue();switch(e.resTyp){case t.ResKey:this.DecResRef(e.resKey);break;case t.DataCache:this.DecDataCache(e.resKey);break;case t.IReference:e.resKey.Return();break;default:console.error("ResMgr.DestroyAutoReleaseItems >> 未处理的回收类型:"+t[e.resTyp])}}else 0<this._i_NextFrameToReleaseResQueue.Count?this._i_Next2FrameToReleaseResQueue.Enqueue(this._i_NextFrameToReleaseResQueue.Dequeue()):(this.__i_StopTickSchedule(),u.ReferencePool.ClearAll())},n.prototype.LoadStage=function(e,t,n,i){var o=this;u.registerUIStage(t,e),this.m_bLoadingGame=!0,u.UIMgr.ins.Open(t,n,function(e,t){null!==o.m_Current&&o.m_Current.Close(),(o.m_Current=e).__i_Init(function(){o.m_bLoadingGame=!1,u.Util.safeCall(i),o.GC()},t)})},n.prototype.LoadBundleStage=function(e,t,n){this.LoadStage(e,e,t,n)},n.prototype.Debug=function(){console.warn(" -------- ResMgr::Debug begin -------- "),this._i_AssetCache.Debug(),console.warn(" -------- ResMgr::Debug end -------- ")},n.ins=null,n);function n(){let n=null!==l&&l.apply(this,arguments)||this;return n._i_AssetCache=new d({addRef:function(e,t){return e.addRef()},decRef:function(e,t){CC_DEBUG&&1===e.refCount&&console.warn("AC >> 资源引用计数为 0, 卸载 "+t),e.decRef()},delete:function(e,t){}}),n._i_LoadingGroupCache=new d({addRef:function(e,t){},decRef:function(e,t){},delete:function(e,t){e.Return()}}),n._i_DataCacheCache=new d({addRef:function(e,t){},decRef:function(e,t){},delete:function(e,t){e.__i_OnUnRegister(),n.node.removeComponent(e),e.destroy(),CC_DEBUG&&console.warn("ResMgr >> 销毁 DataCache: "+t)}}),n._i_NextFrameToReleaseResQueue=u.AnyQueue.Borrow(),n._i_Next2FrameToReleaseResQueue=u.AnyQueue.Borrow(),n._i_TickScheduler=null,n.m_bLoadingGame=!1,n.m_Current=null,n}u.ResMgr=e;let c=(p.GetOrLoadBundle=function(n,t){var i=this,e=cc.assetManager.getBundle(n);if(e)t(e);else if(this._loadingBundleQueues.has(n))this._loadingBundleQueues.get(n).Enqueue(t);else{let e=u.AnyQueue.Borrow();e.Enqueue(t),this._loadingBundleQueues.set(n,e),cc.assetManager.loadBundle(n,function(e,t){if(e)console.error(e);else{let e=i._loadingBundleQueues.get(n);i._loadingResQueues.delete(n),e.RemoveAll(function(e){return e(t)}),e.Return()}})}},p.Load=function(t,n,i,o){var r=this,e=t.get(n,i);if(null==e)if(this._loadingResQueues.has(n))this._loadingResQueues.get(n).Enqueue(o);else{let e=u.AnyQueue.Borrow();e.Enqueue(o),this._loadingResQueues.set(n,e),t.load(n,i,function(e,t){if(e)console.error("L::load >> 加载资源出错 "+n+" 原因: "+e.message);else{let e=r._loadingResQueues.get(n);r._loadingResQueues.delete(n),e.RemoveAll(function(e){return e(t)}),e.Return()}})}else o(e)},p.prototype.loadWithUUID=function(e,n){cc.assetManager.loadAny({uuid:e},function(e,t){e?console.error(e):n(t)})},p.DEBUG=!0,p._loadingResQueues=new Map,p._loadingBundleQueues=new Map,p);function p(){}let h=(f.Borrow=function(){return u.ReferencePool.Borrow(f)},f.prototype.Return=function(){u.ReferencePool.Return(f,this)},f.prototype.Reset=function(){this.loadingRef=0,this.addRef=0,this.decRef=0,this.ref=0,this.asset=null},f);function f(){this.loadingRef=0,this.addRef=0,this.decRef=0,this.ref=0,this.asset=null}let d=(_.prototype.AddLoadingRef=function(t){if(this._resCache.has(t))this._resCache.get(t).loadingRef+=1;else{let e=h.Borrow();e.loadingRef=1,this._resCache.set(t,e)}},_.prototype.DecLoadingRef=function(e){let t=this._resCache.get(e);if(--t.loadingRef,0===t.loadingRef){for(;0<t.addRef;)--t.addRef,++t.ref,this._i_Helper.addRef(t.asset,e);for(;0<t.decRef;)--t.decRef,--t.ref,this._i_Helper.decRef(t.asset,e);this.TryRelease(e)}},_.prototype.AddRef=function(t){if(this._resCache.has(t)){let e=this._resCache.get(t);0<e.ref?(this._i_Helper.addRef(e.asset,t),++e.ref):++e.addRef}else{let e=h.Borrow();e.addRef=1,this._resCache.set(t,e)}},_.prototype.DecRef=function(e){let t=this._resCache.get(e);0<t.loadingRef?++t.decRef:0<t.ref?(this._i_Helper.decRef(t.asset,e),--t.ref,this.TryRelease(e)):0<t.addRef?(--t.addRef,this.TryRelease(e)):console.error("资源管理逻辑出现错误 _i_AC:DecRef >> resKey: "+e)},_.prototype.HasRes=function(e){return!!this._resCache.has(e)&&0<this._resCache.get(e).ref},_.prototype.GetRes=function(e){return this.HasRes(e)?this._resCache.get(e).asset:(console.error("_i_AC::getRes() >> 找不到资源对象 resKey = "+e),null)},_.prototype.SetRes=function(e,t){let n=this._resCache.get(e);null==n.asset||n.asset==t?n.asset=t:console.error("_i_AC::setRes >> 资源关键字 "+e+" 的资源发生了更改，这是错误的！")},_.prototype.TryRelease=function(t){if(this._resCache.has(t)){let e=this._resCache.get(t);0===e.loadingRef&&0===e.addRef&&0===e.decRef&&0===e.ref&&(this._i_Helper.delete(e.asset,t),this._resCache.delete(t),e.Return())}},_.prototype.Debug=function(){console.info("           _resCache >>"),console.info(this._resCache)},_);function _(e){this._i_Helper=null,this._resCache=new Map,this._i_Helper=e}}(numas=numas||{}),function(e){var t,n=(t=e.BaseUIComp,__extends(i,t),i.prototype.$__internal_Create=function(){this.OnCreate()},i.prototype.Close=function(){this._i_Close||(this._i_Close=!0,this.OnRelease(),this.UnbindAllBV(),this.InterrupteAction(),this.__i_CloseAllAutoCloseUIComp(),this.node.removeFromParent(),this.node.destroy())},i.prototype.$__internal_OnOpen=function(e){this._$isOpened_?console.error("UIComp >> 已经处于打开状态，不应该重复调用此方法"):(this._$isOpening_=!0,this._$isOpened_=!0,this.args=e,this.OnOpen(e),this._$isOpening_=!1)},i.prototype.BindBV=function(e,t,n){e.Bind(t,n,this),this._m_BVList_.push(e)},i.prototype.UnbindAllBV=function(){for(;0<this._m_BVList_.length;)this._m_BVList_.pop().TargetUnbind(this)},i.prototype.CloseBy=function(e){return e.__i_AutoCloseUIComp(this)},i.prototype.__i_AutoCloseUIComp=function(e){return this._I_AutoCloseUICompQueue.Enqueue(e),e},Object.defineProperty(i.prototype,"_I_AutoCloseUICompQueue",{get:function(){return null===this._i_UICompQueue&&(this._i_UICompQueue=e.AnyQueue.Borrow()),this._i_UICompQueue},enumerable:!1,configurable:!0}),i.prototype.__i_CloseAllAutoCloseUIComp=function(){null!==this._i_UICompQueue&&(this._i_UICompQueue.RemoveAll(function(e){return e.Close()}),this._i_UICompQueue.Return(),this._i_UICompQueue=null)},i.prototype.onDestroy=function(){this._i_Close||(console.warn("不规范的调用方式 >> 未调用 "+this.name+".Close() 方法进行对象的移除"),this._i_Close=!0,this.OnRelease(),this.InterrupteAction(),this.__i_CloseAllAutoCloseUIComp(),this.UnbindAllBV()),t.prototype.onDestroy.call(this)},Object.defineProperty(i.prototype,"_I_StopCallLinkedList",{get:function(){return null===this._im_StopCallLinkedList&&(this._im_StopCallLinkedList=e.AnyQueue.Borrow()),this._im_StopCallLinkedList},enumerable:!1,configurable:!0}),i.prototype.AddStopActionCall=function(e){this._I_StopCallLinkedList.Enqueue(e)},i.prototype.RemoveStopCall=function(t){this._I_StopCallLinkedList.RemoveFirst(function(e){return e===t})},i.prototype.StopAllAction=function(){var t=this;this._I_StopCallLinkedList.RemoveAll(function(e){return e(t)}),this.node.stopAllActions()},i.prototype.InterrupteAction=function(){null!==this._im_StopCallLinkedList&&0<this._im_StopCallLinkedList.Count&&(this._im_StopCallLinkedList.RemoveAll(),this.node.stopAllActions())},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.args=null,e._$isOpened_=!1,e._$isOpening_=!1,e._i_Close=!1,e._m_BVList_=[],e._i_UICompQueue=null,e._im_StopCallLinkedList=null,e}e.UIComp=n}(numas=numas||{}),function(a){let o=(Object.defineProperty(e,"ins",{get:function(){return null===this._ins&&(this._ins=new e),this._ins},enumerable:!1,configurable:!0}),e.prototype.GetZIndex=function(e){return this._m.get(e)},e.prototype.SetZIndex=function(e,t){CC_DEBUG&&this._m.has(e)?this._m.get(e)!==t&&console.error("UIKey2ZIndex >> "+e+" 前后设置了不同的层级"):this._m.set(e,t)},e._ins=null,e);function e(){this._m=new Map}a.registerUIStage=function(e,t){o.ins.SetZIndex(e,a.UIZIndex.Stage),a.registerRes(e,t,a.EResType.Stage)},a.registerUIPanel=function(e,t,n){o.ins.SetZIndex(e,t),a.registerRes(e,n,a.EResType.Prefab)},a.registerUIComp=function(e,t){a.registerRes(e,t,a.EResType.Prefab)};var t,n=(t=cc.Component,__extends(r,t),r.prototype.onLoad=function(){var t,n=this;for(t in CC_DEBUG&&console.info(">> UIMgr::onLoad"),null===r.ins?r.ins=this:this.destroy(),a.UIZIndex)if(isNaN(t)){let e=new cc.Node("--"+t);e.setContentSize(this.node.getContentSize()),e.parent=this.node;var i=parseInt(a.UIZIndex[t]);e.zIndex=i,this._zs[i]=e}this.block_ref.Bind(function(e){return n.block.v=0<e},!0,this),this.waiting_ref.Bind(function(e){return n.waiting.v=0<e},!0,this)},r.prototype.onDestroy=function(){this.waiting_ref.TargetUnbind(this),this.waiting.TargetUnbind(this),this.block_ref.TargetUnbind(this),this.block.TargetUnbind(this)},r.prototype.LoadStage=function(e,t,n,i){a.ResMgr.ins.LoadStage(e,t,n,i)},r.prototype.LoadBundleStage=function(e,t,n){a.ResMgr.ins.LoadStage(e,e,t,n)},r.prototype.Create=function(e,t,n){var i=a.ResMgr.ins.GetRes(e);let o=cc.instantiate(i),r=o.getComponent(a.UIComp);return null==r&&console.error(">> "+e+" 对应的组件资源没有提前注册"),r.$__internal_Create(),null!=n&&(r.node.parent=n),r.$__internal_OnOpen(t),r},r.prototype.Exist=function(t){for(let e=this._phs.length-1;0<=e;--e)if(this._phs[e].IsSameResKey(t))return!0;return!1},r.prototype.Open=function(e,t,n){var i=o.ins.GetZIndex(e);null==i&&console.error(e+" 拿不到 ZIndex"),this.__Open(e,i,t,n)},r.prototype.__Open=function(e,t,n,i){t=this._zs[t];let o=a.UIPH.Borrow();this._phs.push(o),o.OpenUI(t,e,n,i)},r.prototype.Close=function(){let n=[];for(let e=0;e<arguments.length;e++)n[e]=arguments[e];if("string"==typeof n[0]){var e=n[0],i=n[1];for(let t=this._phs.length-1;0<=t;--t)if(this._phs[t].IsSameResKey(e)){let e=this._phs[t];if(this._phs.splice(t,1),e.CloseUI(),!i)return}}else{let e=n[0],t=e.GetUPH();for(let e=this._phs.length-1;0<=e;--e)if(this._phs[e]===t){this._phs.splice(e,1),t.CloseUI();break}}},r.prototype.AddWaitingRef=function(){++this.waiting_ref.v},r.prototype.DecWaitingRef=function(){--this.waiting_ref.v},r.prototype.AddBlockRef=function(){++this.block_ref.v},r.prototype.DecBlockRef=function(){--this.block_ref.v},r.prototype.blockSeconds=function(e,t){var n=this;++this.block_ref.v,this.scheduleOnce(function(){--n.block_ref.v,a.Util.safeCall(t)},e)},r.prototype.OpenDialog1=function(e,t,n,i){this.Open(a.IIStartPrefabCfg.dft.panel.DialogUIPanel.key,a.DialogUIPanelArgs.Create1(e,t,n,i))},r.prototype.OpenDialog2=function(e,t,n,i,o,r){this.Open(a.IIStartPrefabCfg.dft.panel.DialogUIPanel.key,a.DialogUIPanelArgs.Create2(e,t,n,i,o,r))},r.prototype.OpenDialog3=function(e,t,n,i,o,r,s,u){this.Open(a.IIStartPrefabCfg.dft.panel.DialogUIPanel.key,a.DialogUIPanelArgs.Create3(e,t,n,i,o,r,s,u))},r.prototype.ShowMsg=function(){let t=[];for(let e=0;e<arguments.length;e++)t[e]=arguments[e];this.Open(a.IIStartPrefabCfg.dft.panel.MsgUIPanel.key,{msg:t})},r.prototype.Debug=function(){console.info("UIMgr >> Debug");for(let e=0;e<this._phs.length;++e)console.info("z: "+this._phs[e].node.zIndex+" >> "+this._phs[e].GetResKey())},r.ins=null,r);function r(){let e=null!==t&&t.apply(this,arguments)||this;return e._zs={},e._phs=[],e.waiting_ref=a.NumberBV.Borrow(0),e.waiting=a.BooleanBV.Borrow(!1),e.block_ref=a.NumberBV.Borrow(0),e.block=a.BooleanBV.Borrow(!1),e}a.UIMgr=n}(numas=numas||{}),function(u){var t,e=(t=cc.Component,__extends(n,t),n.Borrow=function(){return u.NodePool.Get("__i_UIPH",n)},n.prototype.IsSameResKey=function(e){return this._prefabKey==e},n.prototype.GetResKey=function(){return this._prefabKey},n.prototype.OpenUI=function(e,o,t,r){var s=this;this._prefabKey=o,this._args=t,this._isLoading=!0,this.node.parent=e,this.node.setContentSize(e.getContentSize()),u.ResMgr.ins.Load(o,function(e,t){s._isLoading=!1;let n=cc.instantiate(e);n.parent=s.node,s.node.name="【UIPH】"+o.substring(o.lastIndexOf("/")+1),n.setContentSize(s.node.getContentSize());let i=n.getComponent(u.UIPanel);i.AutoReleaseRes(t),s._uiPanel=i,i.$__i_InitByUPH(s),i.$__i_OnOpen(s._args),r&&r(s._uiPanel,s._args),s._isCloseAfterLoading&&(s._isCloseAfterLoading=!1,s.CloseUI())})},n.prototype.CloseUI=function(){this._isLoading?this._isCloseAfterLoading=!0:this.__CloseUI()},n.prototype.__CloseUI=function(){this._uiPanel.$__i_CloseByUPH(),this._uiPanel.node.removeFromParent(!0),this._uiPanel.node.destroy(),this._uiPanel=null,this.node.removeFromParent(!0),this._isLoading=!1,this._args=null,this._prefabKey=null,u.NodePool.Put("__i_UIPH",this)},n);function n(){let e=null!==t&&t.apply(this,arguments)||this;return e._prefabKey=null,e._args=null,e._uiPanel=null,e._isLoading=!1,e._isCloseAfterLoading=!1,e}u.UIPH=e}(numas=numas||{}),function(n){var t,e=(t=n.UIPanel,__extends(i,t),i.prototype.OnCreate=function(){},i.prototype.OnRelease=function(){},i.prototype.OnOpen=function(e){},i.prototype.__i_Init=function(e,t){this.m_Initialized?console.error(">> UIStage::OnOpen() >> 已经初始化，错误的使用方式"):(this.m_Initialized=!0,n.AudioMgr.ins.SetDefaultEffect(this.GetDefaultEffectAudioKey()),this.OnInit(n.Util.onceCall(e,1),t))},i);function i(){let e=null!==t&&t.apply(this,arguments)||this;return e.m_Initialized=!1,e}n.UIStage=e}(numas=numas||{}),function(a){var e=(t.getOrAddComponent=function(e,t){let n=e.getComponent(t);return n=n||e.addComponent(t),n},t.transferTo=function(e,t,n){var i;void 0===n&&(n=!1),e.parent!==t&&(i=t.convertToNodeSpaceAR(e.convertToWorldSpaceAR(cc.Vec3.ZERO)),e.removeFromParent(n),e.position=i,t.addChild(e))},t.positionInTarget=function(e,t){e=e.convertToWorldSpaceAR(cc.Vec3.ZERO);return t.convertToNodeSpaceAR(e)},t.fadeInBackgroundAction=function(e,t,n){void 0===t&&(t=255),void 0===n&&(n=.4),this.showAction(e,n,{opacity:t},null,0,!0)},t.fadeOutBackgroundAction=function(e,t,n,i,o){void 0===t&&(t=null),void 0===n&&(n=0),void 0===i&&(i=.3),void 0===o&&(o=.4),this.hideAction(e,i,{opacity:n},t,o,!0)},t.scaleAction=function(e,t){cc.tween(e).to(.15,{scale:t}).to(.2,{scale:1}).start()},t.moveAction=function(e,t,n,i,o,r,s){void 0===i&&(i=.8),void 0===r&&(r=0),void 0===s&&(s=cc.easing.backOut);let u=cc.tween(e);0<r&&u.delay(r),u.to(i,{position:t?cc.Vec3.ZERO:n},{easing:t?s:cc.easing.backIn}),o&&u.call(o),u.start()},t.hideAction=function(e,t,n,i,o,r){return void 0===i&&(i=null),void 0===o&&(o=0),void 0===r&&(r=!0),this.BaseAction(e,!1,t,n,i,o,r)},t.showAction=function(e,t,n,i,o,r){return void 0===i&&(i=null),void 0===o&&(o=0),void 0===r&&(r=!0),this.BaseAction(e,!0,t,n,i,o,r)},t.BaseAction=function(e,t,n,i,o,r,s){if(void 0===o&&(o=null),void 0===r&&(r=0),void 0===s&&(s=!0),0==n)return e.active=t,null===e.scale&&void 0===e.scale||(e.scale=i.scale),null===e.opacity&&void 0===e.opacity||(e.opacity=i.opacity),console.assert(0==r),void(o&&o(e));e.active=!0,s&&a.UIMgr.ins.AddBlockRef();let u=cc.tween(e);0<r&&u.delay(r),u.to(n,i).call(function(e){e.active=t,s&&a.UIMgr.ins.DecBlockRef(),o&&o(e)}).start()},t);function t(){}a.UIUtil=e}(numas=numas||{}),function(u){var e=(t.IntegerTo=function(e,t,n,i,o){this.__IntegerTo(e,t,n,i,o,this.LinearFloorIntegerProgress)},t.CeilIntegerTo=function(e,t,n,i,o){this.__IntegerTo(e,t,n,i,o,this.LinearCeilIntegerProgress)},t.RoundIntegerTo=function(e,t,n,i,o){this.__IntegerTo(e,t,n,i,o,this.LinearRoundIntegerProgress)},t.__IntegerTo=function(e,t,n,i,o,r){let s=u.NumberBV.Borrow(t);s.Bind(i,o,this),cc.tween(s).to(e,{v:n},r).call(function(e){return e.Return()}).start()},t.LinearProgress={progress:function(e,t,n,i){return e+(t-e)*i}},t.LinearFloorIntegerProgress={progress:function(e,t,n,i){return Math.floor(e+(t-e)*i)}},t.LinearCeilIntegerProgress={progress:function(e,t,n,i){return Math.ceil(e+(t-e)*i)}},t.LinearRoundIntegerProgress={progress:function(e,t,n,i){return Math.round(e+(t-e)*i)}},t);function t(){}u.TweenUtil=e}(numas=numas||{});